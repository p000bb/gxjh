import{K as D}from"./el-button-fb691484.js";import{E as x}from"./el-overlay-9e31ebb7.js";/* empty css                */import{d as L,f as T,j as B,k as C}from"./admin-ee59f3a1.js";import"./el-popper-17f91b7a.js";import{E as P}from"./el-tree-select-04f4c75d.js";import F from"./uploadImg-2cd82401.js";import{u as N,a as R,b as q}from"./index-15cc5994.js";import{g as j}from"./index-a14c7d2c.js";import{a as M}from"./index-70f8277e.js";import{d as S,r as n,o as z,y as K,x as O,B as r,E as A,k as o,ay as g}from"./viewer-97ef37b1.js";const G={class:"dialog-footer"},oe=S({__name:"dataDialog",emits:["getPageList"],setup(H,{expose:v,emit:_}){const y=_,d=n(),i=n(!1),p=n(),u=n(),e=n({}),I=n({name:[{required:!0,message:"请输入名称",trigger:"change"}],categoryId:[{required:!0,message:"请选择文件种类",trigger:"change"}],imageUrl:[{required:!0,message:"请上传图片",trigger:"change"}]}),U=()=>{i.value=!1},w=()=>{var t;(t=p.value)==null||t.validate(async l=>{var m;if(l){if(e.value.id){const a=new FormData;a.append("id",e.value.id),a.append("name",e.value.name),a.append("categoryId",e.value.categoryId),(m=u.value)!=null&&m.fileList.length&&a.append("file",u.value.fileList[0].raw),await N(a)}else{const a=new FormData;a.append("name",e.value.name),a.append("file",u.value.fileList[0].raw),a.append("categoryId",e.value.categoryId),await R(a)}i.value=!1,L.success("操作成功"),y("getPageList")}})},V=async t=>{if(t!=null&&t.id){const l=await q(t.id);e.value={...l.data,imageUrl:"https://120.27.223.237/gxjh-file"+l.data.path},d.value="修改图片",i.value=!0}else e.value={categoryId:t.categoryId},d.value="新增图片",i.value=!0},c=n([]),k=async()=>{const t=await j({pageNum:1,pageSize:1e3});c.value=M([...t.data.list])||[]};return z(()=>{k()}),v({openDialog:V}),(t,l)=>{const m=T,a=B,E=P,b=C,f=D,h=x;return K(),O(h,{title:d.value,modelValue:i.value,"onUpdate:modelValue":l[3]||(l[3]=s=>i.value=s),width:"40%","close-on-click-modal":!1,"destroy-on-close":""},{footer:r(()=>[A("div",G,[o(f,{onClick:U},{default:r(()=>[g("取 消")]),_:1}),o(f,{type:"primary",onClick:w},{default:r(()=>[g("保 存")]),_:1})])]),default:r(()=>[o(b,{ref_key:"formRef",ref:p,model:e.value,rules:I.value,"label-width":"auto"},{default:r(()=>[o(a,{label:"名称：",prop:"name"},{default:r(()=>[o(m,{modelValue:e.value.name,"onUpdate:modelValue":l[0]||(l[0]=s=>e.value.name=s),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),o(a,{label:"文件种类：",prop:"categoryId"},{default:r(()=>[o(E,{modelValue:e.value.categoryId,"onUpdate:modelValue":l[1]||(l[1]=s=>e.value.categoryId=s),data:c.value,props:{value:"id",label:"name",children:"children"},"value-key":"id",placeholder:"选择文件种类","check-strictly":"",filterable:"","render-after-expand":!1,class:"w-full"},null,8,["modelValue","data"])]),_:1}),o(a,{label:"图片上传：",prop:"imageUrl"},{default:r(()=>[o(F,{imageUrl:e.value.imageUrl,"onUpdate:imageUrl":l[2]||(l[2]=s=>e.value.imageUrl=s),ref_key:"uploadRef",ref:u},null,8,["imageUrl"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}});export{oe as _};
