import{L}from"./el-button-ce4d76f3.js";import{r as b,v as G}from"./service copy-a1f7ec66.js";import{E as I,a as O,b as j,c as H}from"./el-link-e09e8b53.js";/* empty css                */import{d as N,f as P,n as R,o as S}from"./admin-a54a04d3.js";import{d as U,r,y as q,x as J,B as n,E as F,k as e,ay as f,F as K,o as X,v as T,A as Y,C as z,D as B,I as Z}from"./viewer-de354506.js";import{E as ee}from"./el-overlay-931cfcb0.js";import{E as te}from"./el-input-number-f9410f8a.js";import{a as ae}from"./index-a1a04be3.js";import"./index-3589b39e.js";import"./el-popper-a78eaae7.js";import"./vnode-b3f97862.js";import"./aria-bc8e8b0f.js";import"./debounce-00950313.js";import"./refs-df71abc4.js";import"./index-d8b5141f.js";const y="/category";function le(i){return b({url:y,method:"get",params:{id:i}})}function oe(i){return b({url:`${y}/page`,method:"post",data:i})}function ne(i){return b({url:y,method:"post",data:i})}function se(i){return b({url:y,method:"put",data:i})}function re(i){return b({url:y,method:"delete",params:{id:i}})}const ie={class:"dialog-footer"},ue=U({__name:"dataDialog",emits:["getPageList"],setup(i,{expose:u,emit:w}){const g=w,c=r(),m=r(!1),h=r(),o=r({}),d=r({name:[{required:!0,message:"请输入名称",trigger:"change"}],code:[{required:!0,message:"请输入标识",trigger:"change"}],sort:[{required:!0,message:"请输入排序",trigger:"change"}]}),E=()=>{m.value=!1},v=()=>{var s;(s=h.value)==null||s.validate(async a=>{a&&(o.value.id?await se(o.value):await ne(o.value),m.value=!1,N.success("操作成功"),g("getPageList"))})};return u({openDialog:async s=>{if(s!=null&&s.id){const a=await le(s.id);o.value={id:a.data.id,parentId:a.data.parentId,name:a.data.name,sort:a.data.sort},c.value="修改文件种类",m.value=!0}else o.value={parentId:(s==null?void 0:s.parentId)||0},c.value="新增文件种类",m.value=!0}}),(s,a)=>{const t=P,l=R,C=te,D=S,k=L,x=ee;return q(),J(x,{title:c.value,modelValue:m.value,"onUpdate:modelValue":a[3]||(a[3]=p=>m.value=p),width:"40%","close-on-click-modal":!1,"destroy-on-close":""},{footer:n(()=>[F("div",ie,[e(k,{onClick:E},{default:n(()=>[f("取 消")]),_:1}),e(k,{type:"primary",onClick:v},{default:n(()=>[f("保 存")]),_:1})])]),default:n(()=>[e(D,{ref_key:"formRef",ref:h,model:o.value,rules:d.value,"label-width":"auto"},{default:n(()=>[e(l,{label:"名称：",prop:"name"},{default:n(()=>[e(t,{modelValue:o.value.name,"onUpdate:modelValue":a[0]||(a[0]=p=>o.value.name=p),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),e(l,{label:"标识：",prop:"code"},{default:n(()=>[e(t,{modelValue:o.value.code,"onUpdate:modelValue":a[1]||(a[1]=p=>o.value.code=p),placeholder:"请输入标识"},null,8,["modelValue"])]),_:1}),e(l,{label:"排序：",prop:"sort"},{default:n(()=>[e(C,{modelValue:o.value.sort,"onUpdate:modelValue":a[2]||(a[2]=p=>o.value.sort=p),min:0,"controls-position":"right",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}}),me={class:"container"},pe={class:"table-main"},Ie=U({__name:"index",setup(i){const u=r({pageNum:1,pageSize:10}),w=r(!0),g=r(!1),c=r([]),m=r(0),h=()=>{u.value={pageNum:1,pageSize:10},d()},o=()=>{d()},d=async()=>{g.value=!0,oe(u.value).then(t=>{c.value=ae(t.data.list)||[],m.value=parseInt(t.data.total),g.value=!1})},E=r([{label:"种类名称",prop:"name",width:200,align:"left"},{label:"排序",prop:"sort",minWidth:100},{label:"创建时间",prop:"createTime",minWidth:150},{label:"更新时间",prop:"updateTime",minWidth:150},{label:"操作",prop:"option",fixed:"right",width:200,render:t=>{var l;return e(K,null,[e(I,{class:"table_link_btn",underline:!1,size:"small",type:"primary",icon:"Plus",onClick:()=>V(t.row)},{default:()=>[e("span",{class:"table_link_text"},[f("新增")])]}),e(I,{class:"table_link_btn",underline:!1,size:"small",type:"primary",icon:"Edit",onClick:()=>s(t.row)},{default:()=>[e("span",{class:"table_link_text"},[f("修改")])]}),!((l=t.row)!=null&&l.children)&&e(I,{class:"table_link_btn",underline:!1,size:"small",type:"danger",icon:"Remove",onClick:()=>a(t.row)},{default:()=>[e("span",{class:"table_link_text"},[f("删除")])]})])}}]),v=r(null),V=t=>{v.value.openDialog({parentId:(t==null?void 0:t.id)||0})},s=t=>{v.value.openDialog(t)},a=({id:t})=>{O.confirm("是否删除该条数据",{title:"警告",type:"warning"}).then(()=>{re(t).then(l=>{l.code===0&&(N.success("删除成功"),d())})})};return X(()=>{d()}),(t,l)=>{const C=P,D=R,k=T("form-search"),x=S,p=L,$=j,M=H,W=T("Table"),Q=T("pagination"),A=G;return q(),Y("div",me,[e(Z,{name:"fade"},{default:n(()=>[z(e(x,{model:u.value,inline:!0,"label-width":"auto",class:"search-form"},{default:n(()=>[e(D,{label:"种类名称",prop:"name"},{default:n(()=>[e(C,{modelValue:u.value.name,"onUpdate:modelValue":l[0]||(l[0]=_=>u.value.name=_),placeholder:"请输入种类名称",clearable:""},null,8,["modelValue"])]),_:1}),e(k,{onReset:h,onSearch:o})]),_:1},8,["model"]),[[B,w.value]])]),_:1}),F("div",pe,[e(M,{gutter:10,class:"mb8"},{default:n(()=>[e($,{span:1.5},{default:n(()=>[e(p,{type:"primary",plain:"",icon:"plus",size:"small",onClick:l[1]||(l[1]=_=>V())},{default:n(()=>[f("新增")]),_:1})]),_:1})]),_:1}),z(e(W,{data:c.value,"row-key":"id",columns:E.value},null,8,["data","columns"]),[[A,g.value]]),z(e(Q,{total:m.value,page:u.value.pageNum,"onUpdate:page":l[2]||(l[2]=_=>u.value.pageNum=_),limit:u.value.pageSize,"onUpdate:limit":l[3]||(l[3]=_=>u.value.pageSize=_),onPagination:d},null,8,["total","page","limit"]),[[B,m.value>0]])]),e(ue,{ref_key:"dataDialogRef",ref:v,onGetPageList:d},null,512)])}}});export{Ie as default};
