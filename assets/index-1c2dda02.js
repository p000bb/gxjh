import{L as R}from"./el-button-ce4d76f3.js";import{r as v,v as O}from"./service copy-a1f7ec66.js";import{b as S,c as P,E as B,a as j}from"./el-link-e09e8b53.js";/* empty css                */import{d as U,n as $,f as F,o as q}from"./admin-a54a04d3.js";import{d as M,r as s,y as W,x as H,B as a,E as Z,k as e,ay as _,F as J,o as K,v as L,A as X,C as N,D as Y,I as ee}from"./viewer-de354506.js";import{E as le}from"./el-overlay-931cfcb0.js";import{E as te}from"./el-input-number-f9410f8a.js";import"./el-popper-a78eaae7.js";import{E as ae}from"./el-tree-select-3a693639.js";import{a as Q}from"./index-a1a04be3.js";import"./index-3589b39e.js";import"./vnode-b3f97862.js";import"./aria-bc8e8b0f.js";import"./debounce-00950313.js";import"./refs-df71abc4.js";import"./index-d8b5141f.js";import"./index-708bcd0b.js";const b="/album";function oe(r){return v({url:b,method:"get",params:{id:r}})}function G(r){return v({url:`${b}/page`,method:"post",data:r})}function ne(r){return v({url:b,method:"post",data:r})}function se(r){return v({url:b,method:"put",data:r})}function re(r){return v({url:b,method:"delete",params:{id:r}})}const ue={class:"dialog-footer"},ie=M({__name:"dataDialog",emits:["getPageList"],setup(r,{expose:m,emit:x}){const f=x,d=s(),i=s(!1),h=s(),t=s({}),y=s([]),g=s({name:[{required:!0,message:"请输入名称",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"change"}],phone:[{pattern:/^1[3456789]\d{9}$/,message:"请输入正确的手机号",trigger:"change"}],email:[{pattern:/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+$/,message:"请输入正确的邮箱",trigger:"change"}]}),k=()=>{i.value=!1},D=()=>{var l;(l=h.value)==null||l.validate(async n=>{n&&(t.value.id?await se(t.value):await ne(t.value),i.value=!1,U.success("操作成功"),f("getPageList"))})},C=async l=>{if(o(),l!=null&&l.id){const n=await oe(l.id);t.value={...n.data},d.value="修改图册",i.value=!0}else t.value={parentId:l==null?void 0:l.parentId},d.value="新增图册",i.value=!0},o=async()=>{const l=await G({pageNum:1,pageSize:1e3});y.value=Q([...l.data.list,{id:"0",name:"根"}])||[]};return m({openDialog:C}),(l,n)=>{const T=ae,p=$,c=S,w=F,z=te,I=P,A=q,E=R,V=le;return W(),H(V,{title:d.value,modelValue:i.value,"onUpdate:modelValue":n[4]||(n[4]=u=>i.value=u),width:"40%","close-on-click-modal":!1,"destroy-on-close":""},{footer:a(()=>[Z("div",ue,[e(E,{onClick:k},{default:a(()=>[_("取 消")]),_:1}),e(E,{type:"primary",onClick:D},{default:a(()=>[_("保 存")]),_:1})])]),default:a(()=>[e(A,{ref_key:"formRef",ref:h,model:t.value,rules:g.value,"label-width":"auto"},{default:a(()=>[e(I,null,{default:a(()=>[e(c,{span:24},{default:a(()=>[e(p,{label:"上级图册：",prop:"parentId"},{default:a(()=>[e(T,{modelValue:t.value.parentId,"onUpdate:modelValue":n[0]||(n[0]=u=>t.value.parentId=u),data:y.value,props:{value:"id",label:"name",children:"children"},"value-key":"id",placeholder:"选择上级图册","check-strictly":"",filterable:"","render-after-expand":!1,style:{width:"100%"}},null,8,["modelValue","data"])]),_:1})]),_:1}),e(c,{span:12},{default:a(()=>[e(p,{label:"图册名称：",prop:"name"},{default:a(()=>[e(w,{modelValue:t.value.name,"onUpdate:modelValue":n[1]||(n[1]=u=>t.value.name=u),placeholder:"请输入图册名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:a(()=>[e(p,{label:"排序：",prop:"sort"},{default:a(()=>[e(z,{modelValue:t.value.sort,"onUpdate:modelValue":n[2]||(n[2]=u=>t.value.sort=u),min:0,"controls-position":"right",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:24},{default:a(()=>[e(p,{label:"备注：",prop:"remark"},{default:a(()=>[e(w,{modelValue:t.value.remark,"onUpdate:modelValue":n[3]||(n[3]=u=>t.value.remark=u),placeholder:"请输入备注",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}}),me={class:"container"},de={class:"table-main"},Ie=M({__name:"index",setup(r){const m=s({pageNum:1,pageSize:10}),x=s(!0),f=s(!1),d=s([]),i=()=>{m.value={pageNum:1,pageSize:10},t()},h=()=>{t()},t=async()=>{f.value=!0,G(m.value).then(o=>{d.value=Q(o.data.list)||[],f.value=!1})},y=s([{label:"部门名称",prop:"name",width:200,align:"left"},{label:"排序",prop:"sort",minWidth:100},{label:"创建时间",prop:"createTime",minWidth:150},{label:"更新时间",prop:"updateTime",minWidth:150},{label:"操作",prop:"option",fixed:"right",width:200,render:o=>{var l;return e(J,null,[e(B,{class:"table_link_btn",underline:!1,size:"small",type:"primary",icon:"Plus",onClick:()=>k(o.row)},{default:()=>[e("span",{class:"table_link_text"},[_("新增")])]}),e(B,{class:"table_link_btn",underline:!1,size:"small",type:"primary",icon:"Edit",onClick:()=>D(o.row)},{default:()=>[e("span",{class:"table_link_text"},[_("修改")])]}),!((l=o.row)!=null&&l.children)&&e(B,{class:"table_link_btn",underline:!1,size:"small",type:"danger",icon:"Remove",onClick:()=>C(o.row)},{default:()=>[e("span",{class:"table_link_text"},[_("删除")])]})])}}]),g=s(null),k=o=>{g.value.openDialog({parentId:(o==null?void 0:o.id)||"0"})},D=o=>{g.value.openDialog(o)},C=({id:o})=>{j.confirm("是否删除该条数据",{title:"警告",type:"warning"}).then(()=>{re(o).then(l=>{l.code===0&&(U.success("删除成功"),t())})})};return K(()=>{t()}),(o,l)=>{const n=F,T=$,p=L("form-search"),c=q,w=R,z=S,I=P,A=L("Table"),E=O;return W(),X("div",me,[e(ee,{name:"fade"},{default:a(()=>[N(e(c,{model:m.value,inline:!0,"label-width":"auto",class:"search-form"},{default:a(()=>[e(T,{label:"图册名称",prop:"name"},{default:a(()=>[e(n,{modelValue:m.value.name,"onUpdate:modelValue":l[0]||(l[0]=V=>m.value.name=V),placeholder:"请输入图册名称",clearable:""},null,8,["modelValue"])]),_:1}),e(p,{onReset:i,onSearch:h})]),_:1},8,["model"]),[[Y,x.value]])]),_:1}),Z("div",de,[e(I,{gutter:10,class:"mb8"},{default:a(()=>[e(z,{span:1.5},{default:a(()=>[e(w,{type:"primary",plain:"",icon:"plus",size:"small",onClick:l[1]||(l[1]=V=>k())},{default:a(()=>[_("新增")]),_:1})]),_:1})]),_:1}),N(e(A,{data:d.value,"row-key":"id",columns:y.value},null,8,["data","columns"]),[[E,f.value]])]),e(ie,{ref_key:"dataDialogRef",ref:g,onGetPageList:t},null,512)])}}});export{Ie as default};
