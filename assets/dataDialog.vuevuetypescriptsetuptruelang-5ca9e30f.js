/* empty css             */import{E as D}from"./el-overlay-1dc85f1f.js";import{E as x}from"./el-button-4e36e058.js";/* empty css                */import{E as L}from"./el-input-7ff3e30e.js";import"./el-tag-e05e313c.js";import"./el-select-7c2b4cfc.js";import"./el-scrollbar-874a5079.js";import"./el-popper-bf9c0fd5.js";import{E as T}from"./el-tree-select-843cadf2.js";/* empty css                    */import{E as B,a as C}from"./el-form-item-ef0a5188.js";import P from"./uploadImg-c476c173.js";import{u as F,a as N,b as R}from"./index-da8f2145.js";import{g as q}from"./index-39e0cb16.js";import{a as M}from"./index-7a6f10c9.js";import{G as S}from"./user-89041d09.js";import{d as j,r as i,o as z,y as G,x as O,B as r,E as A,k as o,ag as g}from"./viewer-a917d3a0.js";const H={class:"dialog-footer"},de=j({__name:"dataDialog",emits:["getPageList"],setup(J,{expose:v,emit:_}){const y=_,d=i(),n=i(!1),p=i(),m=i(),e=i({}),E=i({name:[{required:!0,message:"请输入名称",trigger:"change"}],categoryId:[{required:!0,message:"请选择文件种类",trigger:"change"}],imageUrl:[{required:!0,message:"请上传图片",trigger:"change"}]}),I=()=>{n.value=!1},U=()=>{var t;(t=p.value)==null||t.validate(async l=>{var u;if(l){if(e.value.id){const a=new FormData;a.append("id",e.value.id),a.append("name",e.value.name),a.append("categoryId",e.value.categoryId),(u=m.value)!=null&&u.fileList.length&&a.append("file",m.value.fileList[0].raw),await F(a)}else{const a=new FormData;a.append("name",e.value.name),a.append("file",m.value.fileList[0].raw),a.append("categoryId",e.value.categoryId),await N(a)}n.value=!1,S.success("操作成功"),y("getPageList")}})},w=async t=>{if(t!=null&&t.id){const l=await R(t.id);e.value={...l.data,imageUrl:"https://120.27.223.237/gxjh-file/"+l.data.path},d.value="修改图片",n.value=!0}else e.value={categoryId:t.categoryId},d.value="新增图片",n.value=!0},c=i([]),V=async()=>{const t=await q({pageNum:1,pageSize:1e3});c.value=M([...t.data.list])||[]};return z(()=>{V()}),v({openDialog:w}),(t,l)=>{const u=L,a=B,k=T,b=C,f=x,h=D;return G(),O(h,{title:d.value,modelValue:n.value,"onUpdate:modelValue":l[3]||(l[3]=s=>n.value=s),width:"40%","close-on-click-modal":!1,"destroy-on-close":""},{footer:r(()=>[A("div",H,[o(f,{onClick:I},{default:r(()=>[g("取 消")]),_:1}),o(f,{type:"primary",onClick:U},{default:r(()=>[g("保 存")]),_:1})])]),default:r(()=>[o(b,{ref_key:"formRef",ref:p,model:e.value,rules:E.value,"label-width":"auto"},{default:r(()=>[o(a,{label:"名称：",prop:"name"},{default:r(()=>[o(u,{modelValue:e.value.name,"onUpdate:modelValue":l[0]||(l[0]=s=>e.value.name=s),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),o(a,{label:"文件种类：",prop:"categoryId"},{default:r(()=>[o(k,{modelValue:e.value.categoryId,"onUpdate:modelValue":l[1]||(l[1]=s=>e.value.categoryId=s),data:c.value,props:{value:"id",label:"name",children:"children"},"value-key":"id",placeholder:"选择文件种类","check-strictly":"",filterable:"","render-after-expand":!1,class:"w-full"},null,8,["modelValue","data"])]),_:1}),o(a,{label:"图片上传：",prop:"imageUrl"},{default:r(()=>[o(P,{imageUrl:e.value.imageUrl,"onUpdate:imageUrl":l[2]||(l[2]=s=>e.value.imageUrl=s),ref_key:"uploadRef",ref:m},null,8,["imageUrl"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}});export{de as _};
