import{r as T,ap as $,S as j,aq as V,d as N,h as g,B as q,C as R,k as z,D as O,I as D,ai as H,au as I,an as A,aI as S,j as G,c6 as K}from"./viewer-de354506.js";import{I as M,G as x,a as b,D as L,g as U}from"./el-button-ce4d76f3.js";import{w as F,d as y,J,K as Y,L as Z}from"./admin-a54a04d3.js";function Q(t){let e;const s=T(!1),a=$({...t,originalPosition:"",originalOverflow:"",visible:!1});function r(n){a.text=n}function o(){const n=a.parent,l=d.ns;if(!n.vLoadingAddClassList){let i=n.getAttribute("loading-number");i=Number.parseInt(i)-1,i?n.setAttribute("loading-number",i.toString()):(x(n,l.bm("parent","relative")),n.removeAttribute("loading-number")),x(n,l.bm("parent","hidden"))}c(),f.unmount()}function c(){var n,l;(l=(n=d.$el)==null?void 0:n.parentNode)==null||l.removeChild(d.$el)}function v(){var n;t.beforeClose&&!t.beforeClose()||(s.value=!0,clearTimeout(e),e=window.setTimeout(m,400),a.visible=!1,(n=t.closed)==null||n.call(t))}function m(){if(!s.value)return;const n=a.parent;s.value=!1,n.vLoadingAddClassList=void 0,o()}const u=N({name:"ElLoading",setup(n,{expose:l}){const{ns:i,zIndex:E}=M("loading");return l({ns:i,zIndex:E}),()=>{const C=a.spinner||a.svg,B=g("svg",{class:"circular",viewBox:a.svgViewBox?a.svgViewBox:"0 0 50 50",...C?{innerHTML:C}:{}},[g("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),P=a.text?g("p",{class:i.b("text")},[a.text]):void 0;return g(D,{name:i.b("fade"),onAfterLeave:m},{default:q(()=>[R(z("div",{style:{backgroundColor:a.background||""},class:[i.b("mask"),a.customClass,a.fullscreen?"is-fullscreen":""]},[g("div",{class:i.b("spinner")},[B,P])]),[[O,a.visible]])])})}}}),f=j(u),d=f.mount(document.createElement("div"));return{...V(a),setText:r,removeElLoadingChild:c,close:v,handleAfterLeave:m,vm:d,get $el(){return d.$el}}}let p;const W=function(t={}){if(!H)return;const e=X(t);if(e.fullscreen&&p)return p;const s=Q({...e,closed:()=>{var r;(r=e.closed)==null||r.call(e),e.fullscreen&&(p=void 0)}});ee(e,e.parent,s),h(e,e.parent,s),e.parent.vLoadingAddClassList=()=>h(e,e.parent,s);let a=e.parent.getAttribute("loading-number");return a?a=`${Number.parseInt(a)+1}`:a="1",e.parent.setAttribute("loading-number",a),e.parent.appendChild(s.$el),I(()=>s.visible.value=e.visible),e.fullscreen&&(p=s),s},X=t=>{var e,s,a,r;let o;return A(t.target)?o=(e=document.querySelector(t.target))!=null?e:document.body:o=t.target||document.body,{parent:o===document.body||t.body?document.body:o,background:t.background||"",svg:t.svg||"",svgViewBox:t.svgViewBox||"",spinner:t.spinner||!1,text:t.text||"",fullscreen:o===document.body&&((s=t.fullscreen)!=null?s:!0),lock:(a=t.lock)!=null?a:!1,customClass:t.customClass||"",visible:(r=t.visible)!=null?r:!0,target:o}},ee=async(t,e,s)=>{const{nextZIndex:a}=s.vm.zIndex||s.vm._.exposed.zIndex,r={};if(t.fullscreen)s.originalPosition.value=b(document.body,"position"),s.originalOverflow.value=b(document.body,"overflow"),r.zIndex=a();else if(t.parent===document.body){s.originalPosition.value=b(document.body,"position"),await I();for(const o of["top","left"]){const c=o==="top"?"scrollTop":"scrollLeft";r[o]=`${t.target.getBoundingClientRect()[o]+document.body[c]+document.documentElement[c]-Number.parseInt(b(document.body,`margin-${o}`),10)}px`}for(const o of["height","width"])r[o]=`${t.target.getBoundingClientRect()[o]}px`}else s.originalPosition.value=b(e,"position");for(const[o,c]of Object.entries(r))s.$el.style[o]=c},h=(t,e,s)=>{const a=s.vm.ns||s.vm._.exposed.ns;["absolute","fixed","sticky"].includes(s.originalPosition.value)?x(e,a.bm("parent","relative")):L(e,a.bm("parent","relative")),t.fullscreen&&t.lock?L(e,a.bm("parent","hidden")):x(e,a.bm("parent","hidden"))},k=Symbol("ElLoading"),w=(t,e)=>{var s,a,r,o;const c=e.instance,v=n=>S(e.value)?e.value[n]:void 0,m=n=>{const l=A(n)&&(c==null?void 0:c[n])||n;return l&&T(l)},u=n=>m(v(n)||t.getAttribute(`element-loading-${K(n)}`)),f=(s=v("fullscreen"))!=null?s:e.modifiers.fullscreen,d={text:u("text"),svg:u("svg"),svgViewBox:u("svgViewBox"),spinner:u("spinner"),background:u("background"),customClass:u("customClass"),fullscreen:f,target:(a=v("target"))!=null?a:f?void 0:t,body:(r=v("body"))!=null?r:e.modifiers.body,lock:(o=v("lock"))!=null?o:e.modifiers.lock};t[k]={options:d,instance:W(d)}},te=(t,e)=>{for(const s of Object.keys(e))G(e[s])&&(e[s].value=t[s])},ce={mounted(t,e){e.value&&w(t,e)},updated(t,e){const s=t[k];e.oldValue!==e.value&&(e.value&&!e.oldValue?w(t,e):e.value&&e.oldValue?S(e.value)&&te(e.value,s.options):s==null||s.instance.close())},unmounted(t){var e;(e=t[k])==null||e.instance.close()}};function _(){J().logout(),location.reload()}function se(){const t=F.create();return t.interceptors.request.use(e=>e,e=>Promise.reject(e)),t.interceptors.response.use(e=>{var o;const s=e.data,a=(o=e.request)==null?void 0:o.responseType;if(a==="blob"||a==="arraybuffer")return s;const r=s.code;if(r===void 0)return y.error("非本系统的接口"),Promise.reject(new Error("非本系统的接口"));switch(r){case 0:return s;case 401:return _();default:return y.error(s.message||s.msg||"Error"),Promise.reject(new Error("Error"))}},e=>{switch(U(e,"response.status")){case 400:e.message="请求错误";break;case 401:_();break;case 403:e.message="拒绝访问";break;case 404:e.message="请求地址出错";break;case 408:e.message="请求超时";break;case 500:e.message="服务器内部错误";break;case 501:e.message="服务未实现";break;case 502:e.message="网关错误";break;case 503:e.message="服务不可用";break;case 504:e.message="网关超时";break;case 505:e.message="HTTP 版本不受支持";break}return y.error(e.message),Promise.reject(e)}),t}function ae(t){return function(e){const s=Y(),a={headers:{Authorization:s?`Bearer ${s}`:void 0,"Content-Type":"application/json"},timeout:5e4,baseURL:"gxjh-admin",data:{}},r=Z(a,e);return t(r)}}const ne=se(),ie=ae(ne);export{ie as r,ce as v};
