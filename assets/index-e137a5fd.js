import{L as R}from"./el-button-ce4d76f3.js";import{r as b,v as O}from"./service copy-a1f7ec66.js";import{b as S,c as P,E as L,a as j}from"./el-link-e09e8b53.js";/* empty css                */import{d as $,n as F,f as q,o as A}from"./admin-a54a04d3.js";import{d as M,r,y as W,x as H,B as a,E as Z,k as e,ay as f,F as J,o as K,v as U,A as X,C as N,D as Y,I as ee}from"./viewer-de354506.js";import{E as le}from"./el-overlay-931cfcb0.js";import{E as ae}from"./el-input-number-f9410f8a.js";import"./el-popper-a78eaae7.js";import{E as te}from"./el-tree-select-3a693639.js";import{a as Q}from"./index-a1a04be3.js";import"./index-3589b39e.js";import"./vnode-b3f97862.js";import"./aria-bc8e8b0f.js";import"./debounce-00950313.js";import"./refs-df71abc4.js";import"./index-d8b5141f.js";import"./index-708bcd0b.js";const h="/dept";function oe(u){return b({url:h,method:"get",params:{id:u}})}function G(u){return b({url:`${h}/page`,method:"post",data:u})}function ne(u){return b({url:h,method:"post",data:u})}function se(u){return b({url:h,method:"put",data:u})}function re(u){return b({url:h,method:"delete",params:{id:u}})}const ue={class:"dialog-footer"},ie=M({__name:"dataDialog",emits:["getPageList"],setup(u,{expose:d,emit:D}){const v=D,c=r(),i=r(!1),y=r(),l=r({}),V=r([]),g=r({name:[{required:!0,message:"请输入名称",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"change"}],phone:[{pattern:/^1[3456789]\d{9}$/,message:"请输入正确的手机号",trigger:"change"}],email:[{pattern:/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+$/,message:"请输入正确的邮箱",trigger:"change"}]}),k=()=>{i.value=!1},x=()=>{var t;(t=y.value)==null||t.validate(async o=>{o&&(l.value.id?await se(l.value):await ne(l.value),i.value=!1,$.success("操作成功"),v("getPageList"))})},C=async t=>{if(n(),t!=null&&t.id){const o=await oe(t.id);l.value={...o.data},c.value="修改部门",i.value=!0}else l.value={parentId:t==null?void 0:t.parentId},c.value="新增部门",i.value=!0},n=async()=>{const t=await G({pageNum:1,pageSize:1e3});V.value=Q([...t.data.list,{id:"0",name:"根"}])||[]};return d({openDialog:C}),(t,o)=>{const T=te,m=F,p=S,_=q,z=ae,I=P,B=A,w=R,E=le;return W(),H(E,{title:c.value,modelValue:i.value,"onUpdate:modelValue":o[6]||(o[6]=s=>i.value=s),width:"40%","close-on-click-modal":!1,"destroy-on-close":""},{footer:a(()=>[Z("div",ue,[e(w,{onClick:k},{default:a(()=>[f("取 消")]),_:1}),e(w,{type:"primary",onClick:x},{default:a(()=>[f("保 存")]),_:1})])]),default:a(()=>[e(B,{ref_key:"formRef",ref:y,model:l.value,rules:g.value,"label-width":"auto"},{default:a(()=>[e(I,null,{default:a(()=>[e(p,{span:24},{default:a(()=>[e(m,{label:"上级部门：",prop:"parentId"},{default:a(()=>[e(T,{modelValue:l.value.parentId,"onUpdate:modelValue":o[0]||(o[0]=s=>l.value.parentId=s),data:V.value,props:{value:"id",label:"name",children:"children"},"value-key":"id",placeholder:"选择上级部门","check-strictly":"",filterable:"","render-after-expand":!1,style:{width:"100%"}},null,8,["modelValue","data"])]),_:1})]),_:1}),e(p,{span:12},{default:a(()=>[e(m,{label:"部门名称：",prop:"name"},{default:a(()=>[e(_,{modelValue:l.value.name,"onUpdate:modelValue":o[1]||(o[1]=s=>l.value.name=s),placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:a(()=>[e(m,{label:"排序：",prop:"sort"},{default:a(()=>[e(z,{modelValue:l.value.sort,"onUpdate:modelValue":o[2]||(o[2]=s=>l.value.sort=s),min:0,"controls-position":"right",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:a(()=>[e(m,{label:"电话号码：",prop:"phone"},{default:a(()=>[e(_,{modelValue:l.value.phone,"onUpdate:modelValue":o[3]||(o[3]=s=>l.value.phone=s),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:a(()=>[e(m,{label:"邮箱：",prop:"email"},{default:a(()=>[e(_,{modelValue:l.value.email,"onUpdate:modelValue":o[4]||(o[4]=s=>l.value.email=s),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:24},{default:a(()=>[e(m,{label:"备注：",prop:"remark"},{default:a(()=>[e(_,{modelValue:l.value.remark,"onUpdate:modelValue":o[5]||(o[5]=s=>l.value.remark=s),placeholder:"请输入备注",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}}),me={class:"container"},pe={class:"table-main"},Ie=M({__name:"index",setup(u){const d=r({pageNum:1,pageSize:10}),D=r(!0),v=r(!1),c=r([]),i=()=>{d.value={pageNum:1,pageSize:10},l()},y=()=>{l()},l=async()=>{v.value=!0,G(d.value).then(n=>{c.value=Q(n.data.list)||[],v.value=!1})},V=r([{label:"部门名称",prop:"name",width:200,align:"left"},{label:"排序",prop:"sort",minWidth:100},{label:"创建时间",prop:"createTime",minWidth:150},{label:"更新时间",prop:"updateTime",minWidth:150},{label:"操作",prop:"option",fixed:"right",width:200,render:n=>{var t;return e(J,null,[e(L,{class:"table_link_btn",underline:!1,size:"small",type:"primary",icon:"Plus",onClick:()=>k(n.row)},{default:()=>[e("span",{class:"table_link_text"},[f("新增")])]}),e(L,{class:"table_link_btn",underline:!1,size:"small",type:"primary",icon:"Edit",onClick:()=>x(n.row)},{default:()=>[e("span",{class:"table_link_text"},[f("修改")])]}),!((t=n.row)!=null&&t.children)&&e(L,{class:"table_link_btn",underline:!1,size:"small",type:"danger",icon:"Remove",onClick:()=>C(n.row)},{default:()=>[e("span",{class:"table_link_text"},[f("删除")])]})])}}]),g=r(null),k=n=>{g.value.openDialog({parentId:(n==null?void 0:n.id)||"0"})},x=n=>{g.value.openDialog(n)},C=({id:n})=>{j.confirm("是否删除该条数据",{title:"警告",type:"warning"}).then(()=>{re(n).then(t=>{t.code===0&&($.success("删除成功"),l())})})};return K(()=>{l()}),(n,t)=>{const o=q,T=F,m=U("form-search"),p=A,_=R,z=S,I=P,B=U("Table"),w=O;return W(),X("div",me,[e(ee,{name:"fade"},{default:a(()=>[N(e(p,{model:d.value,inline:!0,"label-width":"auto",class:"search-form"},{default:a(()=>[e(T,{label:"部门名称",prop:"name"},{default:a(()=>[e(o,{modelValue:d.value.name,"onUpdate:modelValue":t[0]||(t[0]=E=>d.value.name=E),placeholder:"请输入部门名称",clearable:""},null,8,["modelValue"])]),_:1}),e(m,{onReset:i,onSearch:y})]),_:1},8,["model"]),[[Y,D.value]])]),_:1}),Z("div",pe,[e(I,{gutter:10,class:"mb8"},{default:a(()=>[e(z,{span:1.5},{default:a(()=>[e(_,{type:"primary",plain:"",icon:"plus",size:"small",onClick:t[1]||(t[1]=E=>k())},{default:a(()=>[f("新增")]),_:1})]),_:1})]),_:1}),N(e(B,{data:c.value,"row-key":"id",columns:V.value},null,8,["data","columns"]),[[w,v.value]])]),e(ie,{ref_key:"dataDialogRef",ref:g,onGetPageList:l},null,512)])}}});export{Ie as default};
