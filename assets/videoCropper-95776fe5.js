/* empty css             *//* empty css                   */import{E as gt}from"./el-overlay-1dc85f1f.js";import{U as le,C as Fe,u as vt,E as bt,I as Re}from"./el-input-7ff3e30e.js";import{E as Ie}from"./el-button-4e36e058.js";import{E as wt,a as Ct}from"./el-tab-pane-70e51e74.js";import{E as yt}from"./el-input-number-f0790d3e.js";import"./el-tooltip-4ed993c7.js";import{E as it,b as rt}from"./el-popper-bf9c0fd5.js";import{ad as xt,s as Ne,r as Y,o as _e,w as J,b as H,g as We,d as ee,y as W,A as I,E as v,L as $,O as c,ak as K,ao as ye,a8 as qe,i as at,a0 as kt,F as me,$ as xe,ax as ge,ac as se,a7 as nt,x as ve,B as D,C as ne,a4 as De,k as z,K as ie,ag as He,Y as Se,ae as St,D as pe,aX as Mt,a9 as _t,ai as Et,ab as Be,h as Ot,ap as $t,at as Ht,au as Xt}from"./viewer-a917d3a0.js";import{a as Ee,d as de,f as ce,I as Ge,_ as fe,q as Ae,u as lt,E as Ze,J as Oe,w as ct,g as Pe,G as Je}from"./user-89041d09.js";import{d as ze}from"./debounce-81d01b88.js";import{a as ht,b as ut}from"./use-form-item-a4463e9d.js";import{u as dt,a as Wt}from"./use-form-common-props-ac54b10b.js";import{i as Ye,d as Xe,t as Yt}from"./error-f1912ce6.js";import{C as Lt}from"./index-0414d5d6.js";import{v as Vt}from"./directive-39134a76.js";import"./index-31848957.js";import"./scroll-77ba8cf1.js";import"./vnode-37301cb0.js";import"./focus-trap-c1ca97d6.js";import"./refs-3c71427a.js";import"./index-cb7b6eb7.js";import"./strings-1de25abc.js";import"./index-8a931359.js";import"./index-ee860d2d.js";const Ue=e=>{let t,s;return e.type==="touchend"?(s=e.changedTouches[0].clientY,t=e.changedTouches[0].clientX):e.type.startsWith("touch")?(s=e.touches[0].clientY,t=e.touches[0].clientX):(s=e.clientY,t=e.clientX),{clientX:t,clientY:s}},Tt=Ee({color:{type:de(Object),required:!0},vertical:{type:Boolean,default:!1}});let Le=!1;function Me(e,t){if(!xt)return;const s=function(i){var a;(a=t.drag)==null||a.call(t,i)},o=function(i){var a;document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",o),document.removeEventListener("touchmove",s),document.removeEventListener("touchend",o),document.onselectstart=null,document.ondragstart=null,Le=!1,(a=t.end)==null||a.call(t,i)},r=function(i){var a;Le||(i.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",s),document.addEventListener("mouseup",o),document.addEventListener("touchmove",s),document.addEventListener("touchend",o),Le=!0,(a=t.start)==null||a.call(t,i))};e.addEventListener("mousedown",r),e.addEventListener("touchstart",r)}const It=e=>{const t=We(),s=Ne(),o=Ne();function r(a){a.target!==s.value&&i(a)}function i(a){if(!o.value||!s.value)return;const l=t.vnode.el.getBoundingClientRect(),{clientX:n,clientY:d}=Ue(a);if(e.vertical){let u=d-l.top;u=Math.max(s.value.offsetHeight/2,u),u=Math.min(u,l.height-s.value.offsetHeight/2),e.color.set("alpha",Math.round((u-s.value.offsetHeight/2)/(l.height-s.value.offsetHeight)*100))}else{let u=n-l.left;u=Math.max(s.value.offsetWidth/2,u),u=Math.min(u,l.width-s.value.offsetWidth/2),e.color.set("alpha",Math.round((u-s.value.offsetWidth/2)/(l.width-s.value.offsetWidth)*100))}}return{thumb:s,bar:o,handleDrag:i,handleClick:r}},Nt=(e,{bar:t,thumb:s,handleDrag:o})=>{const r=We(),i=ce("color-alpha-slider"),a=Y(0),h=Y(0),l=Y();function n(){if(!s.value||e.vertical)return 0;const X=r.vnode.el,w=e.color.get("alpha");return X?Math.round(w*(X.offsetWidth-s.value.offsetWidth/2)/100):0}function d(){if(!s.value)return 0;const X=r.vnode.el;if(!e.vertical)return 0;const w=e.color.get("alpha");return X?Math.round(w*(X.offsetHeight-s.value.offsetHeight/2)/100):0}function u(){if(e.color&&e.color.value){const{r:X,g:w,b:P}=e.color.toRgb();return`linear-gradient(to right, rgba(${X}, ${w}, ${P}, 0) 0%, rgba(${X}, ${w}, ${P}, 1) 100%)`}return""}function p(){a.value=n(),h.value=d(),l.value=u()}_e(()=>{if(!t.value||!s.value)return;const X={drag:w=>{o(w)},end:w=>{o(w)}};Me(t.value,X),Me(s.value,X),p()}),J(()=>e.color.get("alpha"),()=>p()),J(()=>e.color.value,()=>p());const y=H(()=>[i.b(),i.is("vertical",e.vertical)]),f=H(()=>i.e("bar")),m=H(()=>i.e("thumb")),x=H(()=>({background:l.value})),S=H(()=>({left:Ge(a.value),top:Ge(h.value)}));return{rootKls:y,barKls:f,barStyle:x,thumbKls:m,thumbStyle:S,update:p}},Bt="ElColorAlphaSlider",At=ee({name:Bt}),Pt=ee({...At,props:Tt,setup(e,{expose:t}){const s=e,{bar:o,thumb:r,handleDrag:i,handleClick:a}=It(s),{rootKls:h,barKls:l,barStyle:n,thumbKls:d,thumbStyle:u,update:p}=Nt(s,{bar:o,thumb:r,handleDrag:i});return t({update:p,bar:o,thumb:r}),(y,f)=>(W(),I("div",{class:$(c(h))},[v("div",{ref_key:"bar",ref:o,class:$(c(l)),style:K(c(n)),onClick:f[0]||(f[0]=(...m)=>c(a)&&c(a)(...m))},null,6),v("div",{ref_key:"thumb",ref:r,class:$(c(d)),style:K(c(u))},null,6)],2))}});var zt=fe(Pt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/alpha-slider.vue"]]);const Ft=ee({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(e){const t=ce("color-hue-slider"),s=We(),o=Y(),r=Y(),i=Y(0),a=Y(0),h=H(()=>e.color.get("hue"));J(()=>h.value,()=>{p()});function l(y){y.target!==o.value&&n(y)}function n(y){if(!r.value||!o.value)return;const m=s.vnode.el.getBoundingClientRect(),{clientX:x,clientY:S}=Ue(y);let X;if(e.vertical){let w=S-m.top;w=Math.min(w,m.height-o.value.offsetHeight/2),w=Math.max(o.value.offsetHeight/2,w),X=Math.round((w-o.value.offsetHeight/2)/(m.height-o.value.offsetHeight)*360)}else{let w=x-m.left;w=Math.min(w,m.width-o.value.offsetWidth/2),w=Math.max(o.value.offsetWidth/2,w),X=Math.round((w-o.value.offsetWidth/2)/(m.width-o.value.offsetWidth)*360)}e.color.set("hue",X)}function d(){if(!o.value)return 0;const y=s.vnode.el;if(e.vertical)return 0;const f=e.color.get("hue");return y?Math.round(f*(y.offsetWidth-o.value.offsetWidth/2)/360):0}function u(){if(!o.value)return 0;const y=s.vnode.el;if(!e.vertical)return 0;const f=e.color.get("hue");return y?Math.round(f*(y.offsetHeight-o.value.offsetHeight/2)/360):0}function p(){i.value=d(),a.value=u()}return _e(()=>{if(!r.value||!o.value)return;const y={drag:f=>{n(f)},end:f=>{n(f)}};Me(r.value,y),Me(o.value,y),p()}),{bar:r,thumb:o,thumbLeft:i,thumbTop:a,hueValue:h,handleClick:l,update:p,ns:t}}});function Rt(e,t,s,o,r,i){return W(),I("div",{class:$([e.ns.b(),e.ns.is("vertical",e.vertical)])},[v("div",{ref:"bar",class:$(e.ns.e("bar")),onClick:t[0]||(t[0]=(...a)=>e.handleClick&&e.handleClick(...a))},null,2),v("div",{ref:"thumb",class:$(e.ns.e("thumb")),style:K({left:e.thumbLeft+"px",top:e.thumbTop+"px"})},null,6)],2)}var Ut=fe(Ft,[["render",Rt],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/hue-slider.vue"]]);const Kt=Ee({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:Ae,popperClass:{type:String,default:""},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},predefine:{type:de(Array)},validateEvent:{type:Boolean,default:!0}}),jt={[le]:e=>ye(e)||Ye(e),[Fe]:e=>ye(e)||Ye(e),activeChange:e=>ye(e)||Ye(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},pt=Symbol("colorPickerContextKey"),Qe=function(e,t,s){return[e,t*s/((e=(2-t)*s)<1?e:2-e)||0,e/2]},qt=function(e){return typeof e=="string"&&e.includes(".")&&Number.parseFloat(e)===1},Dt=function(e){return typeof e=="string"&&e.includes("%")},be=function(e,t){qt(e)&&(e="100%");const s=Dt(e);return e=Math.min(t,Math.max(0,Number.parseFloat(`${e}`))),s&&(e=Number.parseInt(`${e*t}`,10)/100),Math.abs(e-t)<1e-6?1:e%t/Number.parseFloat(t)},et={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},$e=e=>{e=Math.min(Math.round(e),255);const t=Math.floor(e/16),s=e%16;return`${et[t]||t}${et[s]||s}`},tt=function({r:e,g:t,b:s}){return Number.isNaN(+e)||Number.isNaN(+t)||Number.isNaN(+s)?"":`#${$e(e)}${$e(t)}${$e(s)}`},Ve={A:10,B:11,C:12,D:13,E:14,F:15},ue=function(e){return e.length===2?(Ve[e[0].toUpperCase()]||+e[0])*16+(Ve[e[1].toUpperCase()]||+e[1]):Ve[e[1].toUpperCase()]||+e[1]},Gt=function(e,t,s){t=t/100,s=s/100;let o=t;const r=Math.max(s,.01);s*=2,t*=s<=1?s:2-s,o*=r<=1?r:2-r;const i=(s+t)/2,a=s===0?2*o/(r+o):2*t/(s+t);return{h:e,s:a*100,v:i*100}},ot=(e,t,s)=>{e=be(e,255),t=be(t,255),s=be(s,255);const o=Math.max(e,t,s),r=Math.min(e,t,s);let i;const a=o,h=o-r,l=o===0?0:h/o;if(o===r)i=0;else{switch(o){case e:{i=(t-s)/h+(t<s?6:0);break}case t:{i=(s-e)/h+2;break}case s:{i=(e-t)/h+4;break}}i/=6}return{h:i*360,s:l*100,v:a*100}},Ce=function(e,t,s){e=be(e,360)*6,t=be(t,100),s=be(s,100);const o=Math.floor(e),r=e-o,i=s*(1-t),a=s*(1-r*t),h=s*(1-(1-r)*t),l=o%6,n=[s,a,i,i,h,s][l],d=[h,s,s,a,i,i][l],u=[i,i,h,s,s,a][l];return{r:Math.round(n*255),g:Math.round(d*255),b:Math.round(u*255)}};class ke{constructor(t={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const s in t)qe(t,s)&&(this[s]=t[s]);t.value?this.fromString(t.value):this.doOnChange()}set(t,s){if(arguments.length===1&&typeof t=="object"){for(const o in t)qe(t,o)&&this.set(o,t[o]);return}this[`_${t}`]=s,this.doOnChange()}get(t){return t==="alpha"?Math.floor(this[`_${t}`]):this[`_${t}`]}toRgb(){return Ce(this._hue,this._saturation,this._value)}fromString(t){if(!t){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const s=(o,r,i)=>{this._hue=Math.max(0,Math.min(360,o)),this._saturation=Math.max(0,Math.min(100,r)),this._value=Math.max(0,Math.min(100,i)),this.doOnChange()};if(t.includes("hsl")){const o=t.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(r=>r!=="").map((r,i)=>i>2?Number.parseFloat(r):Number.parseInt(r,10));if(o.length===4?this._alpha=Number.parseFloat(o[3])*100:o.length===3&&(this._alpha=100),o.length>=3){const{h:r,s:i,v:a}=Gt(o[0],o[1],o[2]);s(r,i,a)}}else if(t.includes("hsv")){const o=t.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(r=>r!=="").map((r,i)=>i>2?Number.parseFloat(r):Number.parseInt(r,10));o.length===4?this._alpha=Number.parseFloat(o[3])*100:o.length===3&&(this._alpha=100),o.length>=3&&s(o[0],o[1],o[2])}else if(t.includes("rgb")){const o=t.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(r=>r!=="").map((r,i)=>i>2?Number.parseFloat(r):Number.parseInt(r,10));if(o.length===4?this._alpha=Number.parseFloat(o[3])*100:o.length===3&&(this._alpha=100),o.length>=3){const{h:r,s:i,v:a}=ot(o[0],o[1],o[2]);s(r,i,a)}}else if(t.includes("#")){const o=t.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(o))return;let r,i,a;o.length===3?(r=ue(o[0]+o[0]),i=ue(o[1]+o[1]),a=ue(o[2]+o[2])):(o.length===6||o.length===8)&&(r=ue(o.slice(0,2)),i=ue(o.slice(2,4)),a=ue(o.slice(4,6))),o.length===8?this._alpha=ue(o.slice(6))/255*100:(o.length===3||o.length===6)&&(this._alpha=100);const{h,s:l,v:n}=ot(r,i,a);s(h,l,n)}}compare(t){return Math.abs(t._hue-this._hue)<2&&Math.abs(t._saturation-this._saturation)<1&&Math.abs(t._value-this._value)<1&&Math.abs(t._alpha-this._alpha)<1}doOnChange(){const{_hue:t,_saturation:s,_value:o,_alpha:r,format:i}=this;if(this.enableAlpha)switch(i){case"hsl":{const a=Qe(t,s/100,o/100);this.value=`hsla(${t}, ${Math.round(a[1]*100)}%, ${Math.round(a[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${t}, ${Math.round(s)}%, ${Math.round(o)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${tt(Ce(t,s,o))}${$e(r*255/100)}`;break}default:{const{r:a,g:h,b:l}=Ce(t,s,o);this.value=`rgba(${a}, ${h}, ${l}, ${this.get("alpha")/100})`}}else switch(i){case"hsl":{const a=Qe(t,s/100,o/100);this.value=`hsl(${t}, ${Math.round(a[1]*100)}%, ${Math.round(a[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${t}, ${Math.round(s)}%, ${Math.round(o)}%)`;break}case"rgb":{const{r:a,g:h,b:l}=Ce(t,s,o);this.value=`rgb(${a}, ${h}, ${l})`;break}default:this.value=tt(Ce(t,s,o))}}}const Zt=ee({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0}},setup(e){const t=ce("color-predefine"),{currentColor:s}=at(pt),o=Y(i(e.colors,e.color));J(()=>s.value,a=>{const h=new ke;h.fromString(a),o.value.forEach(l=>{l.selected=h.compare(l)})}),kt(()=>{o.value=i(e.colors,e.color)});function r(a){e.color.fromString(e.colors[a])}function i(a,h){return a.map(l=>{const n=new ke;return n.enableAlpha=!0,n.format="rgba",n.fromString(l),n.selected=n.value===h.value,n})}return{rgbaColors:o,handleSelect:r,ns:t}}}),Jt=["onClick"];function Qt(e,t,s,o,r,i){return W(),I("div",{class:$(e.ns.b())},[v("div",{class:$(e.ns.e("colors"))},[(W(!0),I(me,null,xe(e.rgbaColors,(a,h)=>(W(),I("div",{key:e.colors[h],class:$([e.ns.e("color-selector"),e.ns.is("alpha",a._alpha<100),{selected:a.selected}]),onClick:l=>e.handleSelect(h)},[v("div",{style:K({backgroundColor:a.value})},null,4)],10,Jt))),128))],2)],2)}var eo=fe(Zt,[["render",Qt],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/predefine.vue"]]);const to=ee({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(e){const t=ce("color-svpanel"),s=We(),o=Y(0),r=Y(0),i=Y("hsl(0, 100%, 50%)"),a=H(()=>{const n=e.color.get("hue"),d=e.color.get("value");return{hue:n,value:d}});function h(){const n=e.color.get("saturation"),d=e.color.get("value"),u=s.vnode.el,{clientWidth:p,clientHeight:y}=u;r.value=n*p/100,o.value=(100-d)*y/100,i.value=`hsl(${e.color.get("hue")}, 100%, 50%)`}function l(n){const u=s.vnode.el.getBoundingClientRect(),{clientX:p,clientY:y}=Ue(n);let f=p-u.left,m=y-u.top;f=Math.max(0,f),f=Math.min(f,u.width),m=Math.max(0,m),m=Math.min(m,u.height),r.value=f,o.value=m,e.color.set({saturation:f/u.width*100,value:100-m/u.height*100})}return J(()=>a.value,()=>{h()}),_e(()=>{Me(s.vnode.el,{drag:n=>{l(n)},end:n=>{l(n)}}),h()}),{cursorTop:o,cursorLeft:r,background:i,colorValue:a,handleDrag:l,update:h,ns:t}}}),oo=v("div",null,null,-1),so=[oo];function io(e,t,s,o,r,i){return W(),I("div",{class:$(e.ns.b()),style:K({backgroundColor:e.background})},[v("div",{class:$(e.ns.e("white"))},null,2),v("div",{class:$(e.ns.e("black"))},null,2),v("div",{class:$(e.ns.e("cursor")),style:K({top:e.cursorTop+"px",left:e.cursorLeft+"px"})},so,6)],6)}var ro=fe(to,[["render",io],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/sv-panel.vue"]]);const ao=["onKeydown"],no=["id","aria-label","aria-labelledby","aria-description","aria-disabled","tabindex"],lo=ee({name:"ElColorPicker"}),co=ee({...lo,props:Kt,emits:jt,setup(e,{expose:t,emit:s}){const o=e,{t:r}=lt(),i=ce("color"),{formItem:a}=ht(),h=dt(),l=Wt(),{inputId:n,isLabeledByFormItem:d}=ut(o,{formItemContext:a}),u=Y(),p=Y(),y=Y(),f=Y(),m=Y(),x=Y(),{isFocused:S,handleFocus:X,handleBlur:w}=vt(m,{beforeBlur(g){var N;return(N=f.value)==null?void 0:N.isFocusInsideContent(g)},afterBlur(){A(!1),U()}}),P=g=>{if(l.value)return we();X(g)};let L=!0;const E=ge(new ke({enableAlpha:o.showAlpha,format:o.colorFormat||"",value:o.modelValue})),M=Y(!1),C=Y(!1),_=Y(""),V=H(()=>!o.modelValue&&!C.value?"transparent":Z(E,o.showAlpha)),b=H(()=>!o.modelValue&&!C.value?"":E.value),T=H(()=>d.value?void 0:o.label||r("el.colorpicker.defaultLabel")),F=H(()=>d.value?a==null?void 0:a.labelId:void 0),Q=H(()=>[i.b("picker"),i.is("disabled",l.value),i.bm("picker",h.value),i.is("focused",S.value)]);function Z(g,N){if(!(g instanceof ke))throw new TypeError("color should be instance of _color Class");const{r:ae,g:Ke,b:je}=g.toRgb();return N?`rgba(${ae}, ${Ke}, ${je}, ${g.get("alpha")/100})`:`rgb(${ae}, ${Ke}, ${je})`}function A(g){M.value=g}const R=ze(A,100,{leading:!0});function q(){l.value||A(!0)}function j(){R(!1),U()}function U(){se(()=>{o.modelValue?E.fromString(o.modelValue):(E.value="",se(()=>{C.value=!1}))})}function G(){l.value||R(!M.value)}function k(){E.fromString(_.value)}function B(){const g=E.value;s(le,g),s("change",g),o.validateEvent&&(a==null||a.validate("change").catch(N=>Xe())),R(!1),se(()=>{const N=new ke({enableAlpha:o.showAlpha,format:o.colorFormat||"",value:o.modelValue});E.compare(N)||U()})}function te(){R(!1),s(le,null),s("change",null),o.modelValue!==null&&o.validateEvent&&(a==null||a.validate("change").catch(g=>Xe())),U()}function re(g){if(M.value&&(j(),S.value)){const N=new FocusEvent("focus",g);w(N)}}function O(g){g.preventDefault(),g.stopPropagation(),A(!1),U()}function oe(g){switch(g.code){case Oe.enter:case Oe.space:g.preventDefault(),g.stopPropagation(),q(),x.value.focus();break;case Oe.esc:O(g);break}}function he(){m.value.focus()}function we(){m.value.blur()}return _e(()=>{o.modelValue&&(_.value=b.value)}),J(()=>o.modelValue,g=>{g?g&&g!==E.value&&(L=!1,E.fromString(g)):C.value=!1}),J(()=>b.value,g=>{_.value=g,L&&s("activeChange",g),L=!0}),J(()=>E.value,()=>{!o.modelValue&&!C.value&&(C.value=!0)}),J(()=>M.value,()=>{se(()=>{var g,N,ae;(g=u.value)==null||g.update(),(N=p.value)==null||N.update(),(ae=y.value)==null||ae.update()})}),nt(pt,{currentColor:b}),t({color:E,show:q,hide:j,focus:he,blur:we}),(g,N)=>(W(),ve(c(it),{ref_key:"popper",ref:f,visible:M.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[c(i).be("picker","panel"),c(i).b("dropdown"),g.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",transition:`${c(i).namespace.value}-zoom-in-top`,persistent:"",onHide:N[2]||(N[2]=ae=>A(!1))},{content:D(()=>[ne((W(),I("div",{onKeydown:De(O,["esc"])},[v("div",{class:$(c(i).be("dropdown","main-wrapper"))},[z(Ut,{ref_key:"hue",ref:u,class:"hue-slider",color:c(E),vertical:""},null,8,["color"]),z(ro,{ref_key:"sv",ref:p,color:c(E)},null,8,["color"])],2),g.showAlpha?(W(),ve(zt,{key:0,ref_key:"alpha",ref:y,color:c(E)},null,8,["color"])):ie("v-if",!0),g.predefine?(W(),ve(eo,{key:1,ref:"predefine",color:c(E),colors:g.predefine},null,8,["color","colors"])):ie("v-if",!0),v("div",{class:$(c(i).be("dropdown","btns"))},[v("span",{class:$(c(i).be("dropdown","value"))},[z(c(bt),{ref_key:"inputRef",ref:x,modelValue:_.value,"onUpdate:modelValue":N[0]||(N[0]=ae=>_.value=ae),"validate-event":!1,size:"small",onKeyup:De(k,["enter"]),onBlur:k},null,8,["modelValue","onKeyup"])],2),z(c(Ie),{class:$(c(i).be("dropdown","link-btn")),text:"",size:"small",onClick:te},{default:D(()=>[He(Se(c(r)("el.colorpicker.clear")),1)]),_:1},8,["class"]),z(c(Ie),{plain:"",size:"small",class:$(c(i).be("dropdown","btn")),onClick:B},{default:D(()=>[He(Se(c(r)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)],40,ao)),[[c(Lt),re]])]),default:D(()=>[v("div",{id:c(n),ref_key:"triggerRef",ref:m,class:$(c(Q)),role:"button","aria-label":c(T),"aria-labelledby":c(F),"aria-description":c(r)("el.colorpicker.description",{color:g.modelValue||""}),"aria-disabled":c(l),tabindex:c(l)?-1:g.tabindex,onKeydown:oe,onFocus:P,onBlur:N[1]||(N[1]=(...ae)=>c(w)&&c(w)(...ae))},[c(l)?(W(),I("div",{key:0,class:$(c(i).be("picker","mask"))},null,2)):ie("v-if",!0),v("div",{class:$(c(i).be("picker","trigger")),onClick:G},[v("span",{class:$([c(i).be("picker","color"),c(i).is("alpha",g.showAlpha)])},[v("span",{class:$(c(i).be("picker","color-inner")),style:K({backgroundColor:c(V)})},[ne(z(c(Ze),{class:$([c(i).be("picker","icon"),c(i).is("icon-arrow-down")])},{default:D(()=>[z(c(St))]),_:1},8,["class"]),[[pe,g.modelValue||C.value]]),ne(z(c(Ze),{class:$([c(i).be("picker","empty"),c(i).is("icon-close")])},{default:D(()=>[z(c(Mt))]),_:1},8,["class"]),[[pe,!g.modelValue&&!C.value]])],6)],2)],2)],42,no)]),_:1},8,["visible","popper-class","transition"]))}});var ho=fe(co,[["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/color-picker.vue"]]);const uo=ct(ho),ft=Symbol("sliderContextKey"),po=Ee({modelValue:{type:de([Number,Array]),default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:Ae,inputSize:Ae,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:de(Function),default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,debounce:{type:Number,default:300},label:{type:String,default:void 0},rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:de(Function),default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:rt,default:"top"},marks:{type:de(Object)},validateEvent:{type:Boolean,default:!0}}),Te=e=>Pe(e)||_t(e)&&e.every(Pe),fo={[le]:Te,[Re]:Te,[Fe]:Te},mo=(e,t,s)=>{const o=Y();return _e(async()=>{e.range?(Array.isArray(e.modelValue)?(t.firstValue=Math.max(e.min,e.modelValue[0]),t.secondValue=Math.min(e.max,e.modelValue[1])):(t.firstValue=e.min,t.secondValue=e.max),t.oldValue=[t.firstValue,t.secondValue]):(typeof e.modelValue!="number"||Number.isNaN(e.modelValue)?t.firstValue=e.min:t.firstValue=Math.min(e.max,Math.max(e.min,e.modelValue)),t.oldValue=t.firstValue),Et(window,"resize",s),await se(),s()}),{sliderWrapper:o}},go=e=>H(()=>e.marks?Object.keys(e.marks).map(Number.parseFloat).sort((s,o)=>s-o).filter(s=>s<=e.max&&s>=e.min).map(s=>({point:s,position:(s-e.min)*100/(e.max-e.min),mark:e.marks[s]})):[]),vo=(e,t,s)=>{const{form:o,formItem:r}=ht(),i=Ne(),a=Y(),h=Y(),l={firstButton:a,secondButton:h},n=H(()=>e.disabled||(o==null?void 0:o.disabled)||!1),d=H(()=>Math.min(t.firstValue,t.secondValue)),u=H(()=>Math.max(t.firstValue,t.secondValue)),p=H(()=>e.range?`${100*(u.value-d.value)/(e.max-e.min)}%`:`${100*(t.firstValue-e.min)/(e.max-e.min)}%`),y=H(()=>e.range?`${100*(d.value-e.min)/(e.max-e.min)}%`:"0%"),f=H(()=>e.vertical?{height:e.height}:{}),m=H(()=>e.vertical?{height:p.value,bottom:y.value}:{width:p.value,left:y.value}),x=()=>{i.value&&(t.sliderSize=i.value[`client${e.vertical?"Height":"Width"}`])},S=b=>{const T=e.min+b*(e.max-e.min)/100;if(!e.range)return a;let F;return Math.abs(d.value-T)<Math.abs(u.value-T)?F=t.firstValue<t.secondValue?"firstButton":"secondButton":F=t.firstValue>t.secondValue?"firstButton":"secondButton",l[F]},X=b=>{const T=S(b);return T.value.setPosition(b),T},w=b=>{t.firstValue=b,L(e.range?[d.value,u.value]:b)},P=b=>{t.secondValue=b,e.range&&L([d.value,u.value])},L=b=>{s(le,b),s(Re,b)},E=async()=>{await se(),s(Fe,e.range?[d.value,u.value]:e.modelValue)},M=b=>{var T,F,Q,Z,A,R;if(n.value||t.dragging)return;x();let q=0;if(e.vertical){const j=(Q=(F=(T=b.touches)==null?void 0:T.item(0))==null?void 0:F.clientY)!=null?Q:b.clientY;q=(i.value.getBoundingClientRect().bottom-j)/t.sliderSize*100}else{const j=(R=(A=(Z=b.touches)==null?void 0:Z.item(0))==null?void 0:A.clientX)!=null?R:b.clientX,U=i.value.getBoundingClientRect().left;q=(j-U)/t.sliderSize*100}if(!(q<0||q>100))return X(q)};return{elFormItem:r,slider:i,firstButton:a,secondButton:h,sliderDisabled:n,minValue:d,maxValue:u,runwayStyle:f,barStyle:m,resetSize:x,setPosition:X,emitChange:E,onSliderWrapperPrevent:b=>{var T,F;((T=l.firstButton.value)!=null&&T.dragging||(F=l.secondButton.value)!=null&&F.dragging)&&b.preventDefault()},onSliderClick:b=>{M(b)&&E()},onSliderDown:async b=>{const T=M(b);T&&(await se(),T.value.onButtonDown(b))},setFirstValue:w,setSecondValue:P}},{left:bo,down:wo,right:Co,up:yo,home:xo,end:ko,pageUp:So,pageDown:Mo}=Oe,_o=(e,t,s)=>{const o=Y(),r=Y(!1),i=H(()=>t.value instanceof Function),a=H(()=>i.value&&t.value(e.modelValue)||e.modelValue),h=ze(()=>{s.value&&(r.value=!0)},50),l=ze(()=>{s.value&&(r.value=!1)},50);return{tooltip:o,tooltipVisible:r,formatValue:a,displayTooltip:h,hideTooltip:l}},Eo=(e,t,s)=>{const{disabled:o,min:r,max:i,step:a,showTooltip:h,precision:l,sliderSize:n,formatTooltip:d,emitChange:u,resetSize:p,updateDragging:y}=at(ft),{tooltip:f,tooltipVisible:m,formatValue:x,displayTooltip:S,hideTooltip:X}=_o(e,d,h),w=Y(),P=H(()=>`${(e.modelValue-r.value)/(i.value-r.value)*100}%`),L=H(()=>e.vertical?{bottom:P.value}:{left:P.value}),E=()=>{t.hovering=!0,S()},M=()=>{t.hovering=!1,t.dragging||X()},C=k=>{o.value||(k.preventDefault(),q(k),window.addEventListener("mousemove",j),window.addEventListener("touchmove",j),window.addEventListener("mouseup",U),window.addEventListener("touchend",U),window.addEventListener("contextmenu",U),w.value.focus())},_=k=>{o.value||(t.newPosition=Number.parseFloat(P.value)+k/(i.value-r.value)*100,G(t.newPosition),u())},V=()=>{_(-a.value)},b=()=>{_(a.value)},T=()=>{_(-a.value*4)},F=()=>{_(a.value*4)},Q=()=>{o.value||(G(0),u())},Z=()=>{o.value||(G(100),u())},A=k=>{let B=!0;[bo,wo].includes(k.key)?V():[Co,yo].includes(k.key)?b():k.key===xo?Q():k.key===ko?Z():k.key===Mo?T():k.key===So?F():B=!1,B&&k.preventDefault()},R=k=>{let B,te;return k.type.startsWith("touch")?(te=k.touches[0].clientY,B=k.touches[0].clientX):(te=k.clientY,B=k.clientX),{clientX:B,clientY:te}},q=k=>{t.dragging=!0,t.isClick=!0;const{clientX:B,clientY:te}=R(k);e.vertical?t.startY=te:t.startX=B,t.startPosition=Number.parseFloat(P.value),t.newPosition=t.startPosition},j=k=>{if(t.dragging){t.isClick=!1,S(),p();let B;const{clientX:te,clientY:re}=R(k);e.vertical?(t.currentY=re,B=(t.startY-t.currentY)/n.value*100):(t.currentX=te,B=(t.currentX-t.startX)/n.value*100),t.newPosition=t.startPosition+B,G(t.newPosition)}},U=()=>{t.dragging&&(setTimeout(()=>{t.dragging=!1,t.hovering||X(),t.isClick||G(t.newPosition),u()},0),window.removeEventListener("mousemove",j),window.removeEventListener("touchmove",j),window.removeEventListener("mouseup",U),window.removeEventListener("touchend",U),window.removeEventListener("contextmenu",U))},G=async k=>{if(k===null||Number.isNaN(+k))return;k<0?k=0:k>100&&(k=100);const B=100/((i.value-r.value)/a.value);let re=Math.round(k/B)*B*(i.value-r.value)*.01+r.value;re=Number.parseFloat(re.toFixed(l.value)),re!==e.modelValue&&s(le,re),!t.dragging&&e.modelValue!==t.oldValue&&(t.oldValue=e.modelValue),await se(),t.dragging&&S(),f.value.updatePopper()};return J(()=>t.dragging,k=>{y(k)}),{disabled:o,button:w,tooltip:f,tooltipVisible:m,showTooltip:h,wrapperStyle:L,formatValue:x,handleMouseEnter:E,handleMouseLeave:M,onButtonDown:C,onKeyDown:A,setPosition:G}},Oo=(e,t,s,o)=>({stops:H(()=>{if(!e.showStops||e.min>e.max)return[];if(e.step===0)return[];const a=(e.max-e.min)/e.step,h=100*e.step/(e.max-e.min),l=Array.from({length:a-1}).map((n,d)=>(d+1)*h);return e.range?l.filter(n=>n<100*(s.value-e.min)/(e.max-e.min)||n>100*(o.value-e.min)/(e.max-e.min)):l.filter(n=>n>100*(t.firstValue-e.min)/(e.max-e.min))}),getStopStyle:a=>e.vertical?{bottom:`${a}%`}:{left:`${a}%`}}),$o=(e,t,s,o,r,i)=>{const a=n=>{r(le,n),r(Re,n)},h=()=>e.range?![s.value,o.value].every((n,d)=>n===t.oldValue[d]):e.modelValue!==t.oldValue,l=()=>{var n,d;e.min>e.max&&Yt("Slider","min should not be greater than max.");const u=e.modelValue;e.range&&Array.isArray(u)?u[1]<e.min?a([e.min,e.min]):u[0]>e.max?a([e.max,e.max]):u[0]<e.min?a([e.min,u[1]]):u[1]>e.max?a([u[0],e.max]):(t.firstValue=u[0],t.secondValue=u[1],h()&&(e.validateEvent&&((n=i==null?void 0:i.validate)==null||n.call(i,"change").catch(p=>Xe())),t.oldValue=u.slice())):!e.range&&typeof u=="number"&&!Number.isNaN(u)&&(u<e.min?a(e.min):u>e.max?a(e.max):(t.firstValue=u,h()&&(e.validateEvent&&((d=i==null?void 0:i.validate)==null||d.call(i,"change").catch(p=>Xe())),t.oldValue=u)))};l(),J(()=>t.dragging,n=>{n||l()}),J(()=>e.modelValue,(n,d)=>{t.dragging||Array.isArray(n)&&Array.isArray(d)&&n.every((u,p)=>u===d[p])&&t.firstValue===n[0]&&t.secondValue===n[1]||l()},{deep:!0}),J(()=>[e.min,e.max],()=>{l()})},Ho=Ee({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:rt,default:"top"}}),Xo={[le]:e=>Pe(e)},Wo=["tabindex"],Yo=ee({name:"ElSliderButton"}),Lo=ee({...Yo,props:Ho,emits:Xo,setup(e,{expose:t,emit:s}){const o=e,r=ce("slider"),i=ge({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:o.modelValue}),{disabled:a,button:h,tooltip:l,showTooltip:n,tooltipVisible:d,wrapperStyle:u,formatValue:p,handleMouseEnter:y,handleMouseLeave:f,onButtonDown:m,onKeyDown:x,setPosition:S}=Eo(o,i,s),{hovering:X,dragging:w}=Be(i);return t({onButtonDown:m,onKeyDown:x,setPosition:S,hovering:X,dragging:w}),(P,L)=>(W(),I("div",{ref_key:"button",ref:h,class:$([c(r).e("button-wrapper"),{hover:c(X),dragging:c(w)}]),style:K(c(u)),tabindex:c(a)?-1:0,onMouseenter:L[0]||(L[0]=(...E)=>c(y)&&c(y)(...E)),onMouseleave:L[1]||(L[1]=(...E)=>c(f)&&c(f)(...E)),onMousedown:L[2]||(L[2]=(...E)=>c(m)&&c(m)(...E)),onTouchstart:L[3]||(L[3]=(...E)=>c(m)&&c(m)(...E)),onFocus:L[4]||(L[4]=(...E)=>c(y)&&c(y)(...E)),onBlur:L[5]||(L[5]=(...E)=>c(f)&&c(f)(...E)),onKeydown:L[6]||(L[6]=(...E)=>c(x)&&c(x)(...E))},[z(c(it),{ref_key:"tooltip",ref:l,visible:c(d),placement:P.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":P.tooltipClass,disabled:!c(n),persistent:""},{content:D(()=>[v("span",null,Se(c(p)),1)]),default:D(()=>[v("div",{class:$([c(r).e("button"),{hover:c(X),dragging:c(w)}])},null,2)]),_:1},8,["visible","placement","popper-class","disabled"])],46,Wo))}});var st=fe(Lo,[["__file","/home/runner/work/element-plus/element-plus/packages/components/slider/src/button.vue"]]);const Vo=Ee({mark:{type:de([String,Object]),default:void 0}});var To=ee({name:"ElSliderMarker",props:Vo,setup(e){const t=ce("slider"),s=H(()=>ye(e.mark)?e.mark:e.mark.label),o=H(()=>ye(e.mark)?void 0:e.mark.style);return()=>Ot("div",{class:t.e("marks-text"),style:o.value},s.value)}});const Io=["id","role","aria-label","aria-labelledby"],No={key:1},Bo=ee({name:"ElSlider"}),Ao=ee({...Bo,props:po,emits:fo,setup(e,{expose:t,emit:s}){const o=e,r=ce("slider"),{t:i}=lt(),a=ge({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:h,slider:l,firstButton:n,secondButton:d,sliderDisabled:u,minValue:p,maxValue:y,runwayStyle:f,barStyle:m,resetSize:x,emitChange:S,onSliderWrapperPrevent:X,onSliderClick:w,onSliderDown:P,setFirstValue:L,setSecondValue:E}=vo(o,a,s),{stops:M,getStopStyle:C}=Oo(o,a,p,y),{inputId:_,isLabeledByFormItem:V}=ut(o,{formItemContext:h}),b=dt(),T=H(()=>o.inputSize||b.value),F=H(()=>o.label||i("el.slider.defaultLabel",{min:o.min,max:o.max})),Q=H(()=>o.range?o.rangeStartLabel||i("el.slider.defaultRangeStartLabel"):F.value),Z=H(()=>o.formatValueText?o.formatValueText(k.value):`${k.value}`),A=H(()=>o.rangeEndLabel||i("el.slider.defaultRangeEndLabel")),R=H(()=>o.formatValueText?o.formatValueText(B.value):`${B.value}`),q=H(()=>[r.b(),r.m(b.value),r.is("vertical",o.vertical),{[r.m("with-input")]:o.showInput}]),j=go(o);$o(o,a,p,y,s,h);const U=H(()=>{const O=[o.min,o.max,o.step].map(oe=>{const he=`${oe}`.split(".")[1];return he?he.length:0});return Math.max.apply(null,O)}),{sliderWrapper:G}=mo(o,a,x),{firstValue:k,secondValue:B,sliderSize:te}=Be(a),re=O=>{a.dragging=O};return nt(ft,{...Be(o),sliderSize:te,disabled:u,precision:U,emitChange:S,resetSize:x,updateDragging:re}),t({onSliderClick:w}),(O,oe)=>{var he,we;return W(),I("div",{id:O.range?c(_):void 0,ref_key:"sliderWrapper",ref:G,class:$(c(q)),role:O.range?"group":void 0,"aria-label":O.range&&!c(V)?c(F):void 0,"aria-labelledby":O.range&&c(V)?(he=c(h))==null?void 0:he.labelId:void 0,onTouchstart:oe[2]||(oe[2]=(...g)=>c(X)&&c(X)(...g)),onTouchmove:oe[3]||(oe[3]=(...g)=>c(X)&&c(X)(...g))},[v("div",{ref_key:"slider",ref:l,class:$([c(r).e("runway"),{"show-input":O.showInput&&!O.range},c(r).is("disabled",c(u))]),style:K(c(f)),onMousedown:oe[0]||(oe[0]=(...g)=>c(P)&&c(P)(...g)),onTouchstart:oe[1]||(oe[1]=(...g)=>c(P)&&c(P)(...g))},[v("div",{class:$(c(r).e("bar")),style:K(c(m))},null,6),z(st,{id:O.range?void 0:c(_),ref_key:"firstButton",ref:n,"model-value":c(k),vertical:O.vertical,"tooltip-class":O.tooltipClass,placement:O.placement,role:"slider","aria-label":O.range||!c(V)?c(Q):void 0,"aria-labelledby":!O.range&&c(V)?(we=c(h))==null?void 0:we.labelId:void 0,"aria-valuemin":O.min,"aria-valuemax":O.range?c(B):O.max,"aria-valuenow":c(k),"aria-valuetext":c(Z),"aria-orientation":O.vertical?"vertical":"horizontal","aria-disabled":c(u),"onUpdate:modelValue":c(L)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),O.range?(W(),ve(st,{key:0,ref_key:"secondButton",ref:d,"model-value":c(B),vertical:O.vertical,"tooltip-class":O.tooltipClass,placement:O.placement,role:"slider","aria-label":c(A),"aria-valuemin":c(k),"aria-valuemax":O.max,"aria-valuenow":c(B),"aria-valuetext":c(R),"aria-orientation":O.vertical?"vertical":"horizontal","aria-disabled":c(u),"onUpdate:modelValue":c(E)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):ie("v-if",!0),O.showStops?(W(),I("div",No,[(W(!0),I(me,null,xe(c(M),(g,N)=>(W(),I("div",{key:N,class:$(c(r).e("stop")),style:K(c(C)(g))},null,6))),128))])):ie("v-if",!0),c(j).length>0?(W(),I(me,{key:2},[v("div",null,[(W(!0),I(me,null,xe(c(j),(g,N)=>(W(),I("div",{key:N,style:K(c(C)(g.position)),class:$([c(r).e("stop"),c(r).e("marks-stop")])},null,6))),128))]),v("div",{class:$(c(r).e("marks"))},[(W(!0),I(me,null,xe(c(j),(g,N)=>(W(),ve(c(To),{key:N,mark:g.mark,style:K(c(C)(g.position))},null,8,["mark","style"]))),128))],2)],64)):ie("v-if",!0)],38),O.showInput&&!O.range?(W(),ve(c(yt),{key:0,ref:"input","model-value":c(k),class:$(c(r).e("input")),step:O.step,disabled:c(u),controls:O.showInputControls,min:O.min,max:O.max,debounce:O.debounce,size:c(T),"onUpdate:modelValue":c(L),onChange:c(S)},null,8,["model-value","class","step","disabled","controls","min","max","debounce","size","onUpdate:modelValue","onChange"])):ie("v-if",!0)],42,Io)}}});var Po=fe(Ao,[["__file","/home/runner/work/element-plus/element-plus/packages/components/slider/src/slider.vue"]]);const zo=ct(Po);const mt={};mt.getData=e=>new Promise((t,s)=>{let o={};Fo(e).then(r=>{o.arrayBuffer=r;try{o.orientation=jo(r)}catch{o.orientation=-1}t(o)}).catch(r=>{s(r)})});function Fo(e){let t=null;return new Promise((s,o)=>{if(e.src)if(/^data\:/i.test(e.src))t=Uo(e.src),s(t);else if(/^blob\:/i.test(e.src)){var r=new FileReader;r.onload=function(a){t=a.target.result,s(t)},Ro(e.src,function(a){r.readAsArrayBuffer(a)})}else{var i=new XMLHttpRequest;i.onload=function(){if(this.status==200||this.status===0)t=i.response,s(t);else throw"Could not load image";i=null},i.open("GET",e.src,!0),i.responseType="arraybuffer",i.send(null)}else o("img error")})}function Ro(e,t){var s=new XMLHttpRequest;s.open("GET",e,!0),s.responseType="blob",s.onload=function(o){(this.status==200||this.status===0)&&t(this.response)},s.send()}function Uo(e,t){t=t||e.match(/^data\:([^\;]+)\;base64,/mi)[1]||"",e=e.replace(/^data\:([^\;]+)\;base64,/gmi,"");for(var s=atob(e),o=s.length%2==0?s.length:s.length+1,r=new ArrayBuffer(o),i=new Uint16Array(r),a=0;a<o;a++)i[a]=s.charCodeAt(a);return r}function Ko(e,t,s){var o="",r;for(r=t,s+=t;r<s;r++)o+=String.fromCharCode(e.getUint8(r));return o}function jo(e){var t=new DataView(e),s=t.byteLength,o,r,i,a,h,l,n,d,u,p;if(t.getUint8(0)===255&&t.getUint8(1)===216)for(u=2;u<s;){if(t.getUint8(u)===255&&t.getUint8(u+1)===225){n=u;break}u++}if(n&&(r=n+4,i=n+10,Ko(t,r,4)==="Exif"&&(l=t.getUint16(i),h=l===18761,(h||l===19789)&&t.getUint16(i+2,h)===42&&(a=t.getUint32(i+4,h),a>=8&&(d=i+a)))),d){for(s=t.getUint16(d,h),p=0;p<s;p++)if(u=d+p*12+2,t.getUint16(u,h)===274){u+=8,o=t.getUint16(u,h);break}}return o}const qo=(e,t)=>{const s=e.__vccOpts||e;for(const[o,r]of t)s[o]=r;return s},Do=ee({data:function(){return{w:0,h:0,scale:1,x:0,y:0,loading:!0,trueWidth:0,trueHeight:0,move:!0,moveX:0,moveY:0,crop:!1,cropping:!1,cropW:0,cropH:0,cropOldW:0,cropOldH:0,canChangeX:!1,canChangeY:!1,changeCropTypeX:1,changeCropTypeY:1,cropX:0,cropY:0,cropChangeX:0,cropChangeY:0,cropOffsertX:0,cropOffsertY:0,support:"",touches:[],touchNow:!1,rotate:0,isIos:!1,orientation:0,imgs:"",coe:.2,scaling:!1,scalingSet:"",coeStatus:"",isCanShow:!0}},props:{img:{type:[String,Blob,null,File],default:""},outputSize:{type:Number,default:1},outputType:{type:String,default:"jpeg"},info:{type:Boolean,default:!0},canScale:{type:Boolean,default:!0},autoCrop:{type:Boolean,default:!1},autoCropWidth:{type:[Number,String],default:0},autoCropHeight:{type:[Number,String],default:0},fixed:{type:Boolean,default:!1},fixedNumber:{type:Array,default:()=>[1,1]},fixedBox:{type:Boolean,default:!1},full:{type:Boolean,default:!1},canMove:{type:Boolean,default:!0},canMoveBox:{type:Boolean,default:!0},original:{type:Boolean,default:!1},centerBox:{type:Boolean,default:!1},high:{type:Boolean,default:!0},infoTrue:{type:Boolean,default:!1},maxImgSize:{type:[Number,String],default:2e3},enlarge:{type:[Number,String],default:1},preW:{type:[Number,String],default:0},mode:{type:String,default:"contain"},limitMinSize:{type:[Number,Array,String],default:()=>10,validator:function(e){return Array.isArray(e)?Number(e[0])>=0&&Number(e[1])>=0:Number(e)>=0}},fillColor:{type:String,default:""}},computed:{cropInfo(){let e={};if(e.top=this.cropOffsertY>21?"-21px":"0px",e.width=this.cropW>0?this.cropW:0,e.height=this.cropH>0?this.cropH:0,this.infoTrue){let t=1;this.high&&!this.full&&(t=window.devicePixelRatio),this.enlarge!==1&!this.full&&(t=Math.abs(Number(this.enlarge))),e.width=e.width*t,e.height=e.height*t,this.full&&(e.width=e.width/this.scale,e.height=e.height/this.scale)}return e.width=e.width.toFixed(0),e.height=e.height.toFixed(0),e},isIE(){return!!window.ActiveXObject||"ActiveXObject"in window},passive(){return this.isIE?null:{passive:!1}}},watch:{img(){this.checkedImg()},imgs(e){e!==""&&this.reload()},cropW(){this.showPreview()},cropH(){this.showPreview()},cropOffsertX(){this.showPreview()},cropOffsertY(){this.showPreview()},scale(e,t){this.showPreview()},x(){this.showPreview()},y(){this.showPreview()},autoCrop(e){e&&this.goAutoCrop()},autoCropWidth(){this.autoCrop&&this.goAutoCrop()},autoCropHeight(){this.autoCrop&&this.goAutoCrop()},mode(){this.checkedImg()},rotate(){this.showPreview(),this.autoCrop?this.goAutoCrop(this.cropW,this.cropH):(this.cropW>0||this.cropH>0)&&this.goAutoCrop(this.cropW,this.cropH)}},methods:{getVersion(e){var t=navigator.userAgent.split(" "),s="";let o=0;const r=new RegExp(e,"i");for(var i=0;i<t.length;i++)r.test(t[i])&&(s=t[i]);return s?o=s.split("/")[1].split("."):o=["0","0","0"],o},checkOrientationImage(e,t,s,o){if(this.getVersion("chrome")[0]>=81)t=-1;else if(this.getVersion("safari")[0]>=605){const a=this.getVersion("version");a[0]>13&&a[1]>1&&(t=-1)}else{const a=navigator.userAgent.toLowerCase().match(/cpu iphone os (.*?) like mac os/);if(a){let h=a[1];h=h.split("_"),(h[0]>13||h[0]>=13&&h[1]>=4)&&(t=-1)}}let r=document.createElement("canvas"),i=r.getContext("2d");switch(i.save(),t){case 2:r.width=s,r.height=o,i.translate(s,0),i.scale(-1,1);break;case 3:r.width=s,r.height=o,i.translate(s/2,o/2),i.rotate(180*Math.PI/180),i.translate(-s/2,-o/2);break;case 4:r.width=s,r.height=o,i.translate(0,o),i.scale(1,-1);break;case 5:r.height=s,r.width=o,i.rotate(.5*Math.PI),i.scale(1,-1);break;case 6:r.width=o,r.height=s,i.translate(o/2,s/2),i.rotate(90*Math.PI/180),i.translate(-s/2,-o/2);break;case 7:r.height=s,r.width=o,i.rotate(.5*Math.PI),i.translate(s,-o),i.scale(-1,1);break;case 8:r.height=s,r.width=o,i.translate(o/2,s/2),i.rotate(-90*Math.PI/180),i.translate(-s/2,-o/2);break;default:r.width=s,r.height=o}i.drawImage(e,0,0,s,o),i.restore(),r.toBlob(a=>{let h=URL.createObjectURL(a);URL.revokeObjectURL(this.imgs),this.imgs=h},"image/"+this.outputType,1)},checkedImg(){if(this.img===null||this.img===""){this.imgs="",this.clearCrop();return}this.loading=!0,this.scale=1,this.rotate=0,this.clearCrop();let e=new Image;if(e.onload=()=>{if(this.img==="")return this.$emit("img-load",new Error("图片不能为空")),!1;let s=e.width,o=e.height;mt.getData(e).then(r=>{this.orientation=r.orientation||1;let i=Number(this.maxImgSize);if(!this.orientation&&s<i&o<i){this.imgs=this.img;return}s>i&&(o=o/s*i,s=i),o>i&&(s=s/o*i,o=i),this.checkOrientationImage(e,this.orientation,s,o)}).catch(r=>{this.$emit("img-load","error"),this.$emit("img-load-error",r)})},e.onerror=s=>{this.$emit("img-load","error"),this.$emit("img-load-error",s)},this.img.substr(0,4)!=="data"&&(e.crossOrigin=""),this.isIE){var t=new XMLHttpRequest;t.onload=function(){var s=URL.createObjectURL(this.response);e.src=s},t.open("GET",this.img,!0),t.responseType="blob",t.send()}else e.src=this.img},startMove(e){if(e.preventDefault(),this.move&&!this.crop){if(!this.canMove)return!1;this.moveX=("clientX"in e?e.clientX:e.touches[0].clientX)-this.x,this.moveY=("clientY"in e?e.clientY:e.touches[0].clientY)-this.y,e.touches?(window.addEventListener("touchmove",this.moveImg),window.addEventListener("touchend",this.leaveImg),e.touches.length==2&&(this.touches=e.touches,window.addEventListener("touchmove",this.touchScale),window.addEventListener("touchend",this.cancelTouchScale))):(window.addEventListener("mousemove",this.moveImg),window.addEventListener("mouseup",this.leaveImg)),this.$emit("img-moving",{moving:!0,axis:this.getImgAxis()})}else this.cropping=!0,window.addEventListener("mousemove",this.createCrop),window.addEventListener("mouseup",this.endCrop),window.addEventListener("touchmove",this.createCrop),window.addEventListener("touchend",this.endCrop),this.cropOffsertX=e.offsetX?e.offsetX:e.touches[0].pageX-this.$refs.cropper.offsetLeft,this.cropOffsertY=e.offsetY?e.offsetY:e.touches[0].pageY-this.$refs.cropper.offsetTop,this.cropX="clientX"in e?e.clientX:e.touches[0].clientX,this.cropY="clientY"in e?e.clientY:e.touches[0].clientY,this.cropChangeX=this.cropOffsertX,this.cropChangeY=this.cropOffsertY,this.cropW=0,this.cropH=0},touchScale(e){e.preventDefault();let t=this.scale;var s={x:this.touches[0].clientX,y:this.touches[0].clientY},o={x:e.touches[0].clientX,y:e.touches[0].clientY},r={x:this.touches[1].clientX,y:this.touches[1].clientY},i={x:e.touches[1].clientX,y:e.touches[1].clientY},a=Math.sqrt(Math.pow(s.x-r.x,2)+Math.pow(s.y-r.y,2)),h=Math.sqrt(Math.pow(o.x-i.x,2)+Math.pow(o.y-i.y,2)),l=h-a,n=1;n=n/this.trueWidth>n/this.trueHeight?n/this.trueHeight:n/this.trueWidth,n=n>.1?.1:n;var d=n*l;if(!this.touchNow){if(this.touchNow=!0,l>0?t+=Math.abs(d):l<0&&t>Math.abs(d)&&(t-=Math.abs(d)),this.touches=e.touches,setTimeout(()=>{this.touchNow=!1},8),!this.checkoutImgAxis(this.x,this.y,t))return!1;this.scale=t}},cancelTouchScale(e){window.removeEventListener("touchmove",this.touchScale)},moveImg(e){if(e.preventDefault(),e.touches&&e.touches.length===2)return this.touches=e.touches,window.addEventListener("touchmove",this.touchScale),window.addEventListener("touchend",this.cancelTouchScale),window.removeEventListener("touchmove",this.moveImg),!1;let t="clientX"in e?e.clientX:e.touches[0].clientX,s="clientY"in e?e.clientY:e.touches[0].clientY,o,r;o=t-this.moveX,r=s-this.moveY,this.$nextTick(()=>{if(this.centerBox){let i=this.getImgAxis(o,r,this.scale),a=this.getCropAxis(),h=this.trueHeight*this.scale,l=this.trueWidth*this.scale,n,d,u,p;switch(this.rotate){case 1:case-1:case 3:case-3:n=this.cropOffsertX-this.trueWidth*(1-this.scale)/2+(h-l)/2,d=this.cropOffsertY-this.trueHeight*(1-this.scale)/2+(l-h)/2,u=n-h+this.cropW,p=d-l+this.cropH;break;default:n=this.cropOffsertX-this.trueWidth*(1-this.scale)/2,d=this.cropOffsertY-this.trueHeight*(1-this.scale)/2,u=n-l+this.cropW,p=d-h+this.cropH;break}i.x1>=a.x1&&(o=n),i.y1>=a.y1&&(r=d),i.x2<=a.x2&&(o=u),i.y2<=a.y2&&(r=p)}this.x=o,this.y=r,this.$emit("img-moving",{moving:!0,axis:this.getImgAxis()})})},leaveImg(e){window.removeEventListener("mousemove",this.moveImg),window.removeEventListener("touchmove",this.moveImg),window.removeEventListener("mouseup",this.leaveImg),window.removeEventListener("touchend",this.leaveImg),this.$emit("img-moving",{moving:!1,axis:this.getImgAxis()})},scaleImg(){this.canScale&&window.addEventListener(this.support,this.changeSize,this.passive)},cancelScale(){this.canScale&&window.removeEventListener(this.support,this.changeSize)},changeSize(e){e.preventDefault();let t=this.scale;var s=e.deltaY||e.wheelDelta,o=navigator.userAgent.indexOf("Firefox");s=o>0?s*30:s,this.isIE&&(s=-s);var r=this.coe;r=r/this.trueWidth>r/this.trueHeight?r/this.trueHeight:r/this.trueWidth;var i=r*s;i<0?t+=Math.abs(i):t>Math.abs(i)&&(t-=Math.abs(i));let a=i<0?"add":"reduce";if(a!==this.coeStatus&&(this.coeStatus=a,this.coe=.2),this.scaling||(this.scalingSet=setTimeout(()=>{this.scaling=!1,this.coe=this.coe+=.01},50)),this.scaling=!0,!this.checkoutImgAxis(this.x,this.y,t))return!1;this.scale=t},changeScale(e){let t=this.scale;e=e||1;var s=20;if(s=s/this.trueWidth>s/this.trueHeight?s/this.trueHeight:s/this.trueWidth,e=e*s,e>0?t+=Math.abs(e):t>Math.abs(e)&&(t-=Math.abs(e)),!this.checkoutImgAxis(this.x,this.y,t))return!1;this.scale=t},createCrop(e){e.preventDefault();var t="clientX"in e?e.clientX:e.touches?e.touches[0].clientX:0,s="clientY"in e?e.clientY:e.touches?e.touches[0].clientY:0;this.$nextTick(()=>{var o=t-this.cropX,r=s-this.cropY;if(o>0?(this.cropW=o+this.cropChangeX>this.w?this.w-this.cropChangeX:o,this.cropOffsertX=this.cropChangeX):(this.cropW=this.w-this.cropChangeX+Math.abs(o)>this.w?this.cropChangeX:Math.abs(o),this.cropOffsertX=this.cropChangeX+o>0?this.cropChangeX+o:0),!this.fixed)r>0?(this.cropH=r+this.cropChangeY>this.h?this.h-this.cropChangeY:r,this.cropOffsertY=this.cropChangeY):(this.cropH=this.h-this.cropChangeY+Math.abs(r)>this.h?this.cropChangeY:Math.abs(r),this.cropOffsertY=this.cropChangeY+r>0?this.cropChangeY+r:0);else{var i=this.cropW/this.fixedNumber[0]*this.fixedNumber[1];i+this.cropOffsertY>this.h?(this.cropH=this.h-this.cropOffsertY,this.cropW=this.cropH/this.fixedNumber[1]*this.fixedNumber[0],o>0?this.cropOffsertX=this.cropChangeX:this.cropOffsertX=this.cropChangeX-this.cropW):this.cropH=i,this.cropOffsertY=this.cropOffsertY}})},changeCropSize(e,t,s,o,r){e.preventDefault(),window.addEventListener("mousemove",this.changeCropNow),window.addEventListener("mouseup",this.changeCropEnd),window.addEventListener("touchmove",this.changeCropNow),window.addEventListener("touchend",this.changeCropEnd),this.canChangeX=t,this.canChangeY=s,this.changeCropTypeX=o,this.changeCropTypeY=r,this.cropX="clientX"in e?e.clientX:e.touches[0].clientX,this.cropY="clientY"in e?e.clientY:e.touches[0].clientY,this.cropOldW=this.cropW,this.cropOldH=this.cropH,this.cropChangeX=this.cropOffsertX,this.cropChangeY=this.cropOffsertY,this.fixed&&this.canChangeX&&this.canChangeY&&(this.canChangeY=0),this.$emit("change-crop-size",{width:this.cropW,height:this.cropH})},changeCropNow(e){e.preventDefault();var t="clientX"in e?e.clientX:e.touches?e.touches[0].clientX:0,s="clientY"in e?e.clientY:e.touches?e.touches[0].clientY:0;let o=this.w,r=this.h,i=0,a=0;if(this.centerBox){let n=this.getImgAxis(),d=n.x2,u=n.y2;i=n.x1>0?n.x1:0,a=n.y1>0?n.y1:0,o>d&&(o=d),r>u&&(r=u)}const[h,l]=this.checkCropLimitSize();this.$nextTick(()=>{var n=t-this.cropX,d=s-this.cropY;if(this.canChangeX&&(this.changeCropTypeX===1?this.cropOldW-n<h?(this.cropW=h,this.cropOffsertX=this.cropOldW+this.cropChangeX-i-h):this.cropOldW-n>0?(this.cropW=o-this.cropChangeX-n<=o-i?this.cropOldW-n:this.cropOldW+this.cropChangeX-i,this.cropOffsertX=o-this.cropChangeX-n<=o-i?this.cropChangeX+n:i):(this.cropW=Math.abs(n)+this.cropChangeX<=o?Math.abs(n)-this.cropOldW:o-this.cropOldW-this.cropChangeX,this.cropOffsertX=this.cropChangeX+this.cropOldW):this.changeCropTypeX===2&&(this.cropOldW+n<h?this.cropW=h:this.cropOldW+n>0?(this.cropW=this.cropOldW+n+this.cropOffsertX<=o?this.cropOldW+n:o-this.cropOffsertX,this.cropOffsertX=this.cropChangeX):(this.cropW=o-this.cropChangeX+Math.abs(n+this.cropOldW)<=o-i?Math.abs(n+this.cropOldW):this.cropChangeX-i,this.cropOffsertX=o-this.cropChangeX+Math.abs(n+this.cropOldW)<=o-i?this.cropChangeX-Math.abs(n+this.cropOldW):i))),this.canChangeY&&(this.changeCropTypeY===1?this.cropOldH-d<l?(this.cropH=l,this.cropOffsertY=this.cropOldH+this.cropChangeY-a-l):this.cropOldH-d>0?(this.cropH=r-this.cropChangeY-d<=r-a?this.cropOldH-d:this.cropOldH+this.cropChangeY-a,this.cropOffsertY=r-this.cropChangeY-d<=r-a?this.cropChangeY+d:a):(this.cropH=Math.abs(d)+this.cropChangeY<=r?Math.abs(d)-this.cropOldH:r-this.cropOldH-this.cropChangeY,this.cropOffsertY=this.cropChangeY+this.cropOldH):this.changeCropTypeY===2&&(this.cropOldH+d<l?this.cropH=l:this.cropOldH+d>0?(this.cropH=this.cropOldH+d+this.cropOffsertY<=r?this.cropOldH+d:r-this.cropOffsertY,this.cropOffsertY=this.cropChangeY):(this.cropH=r-this.cropChangeY+Math.abs(d+this.cropOldH)<=r-a?Math.abs(d+this.cropOldH):this.cropChangeY-a,this.cropOffsertY=r-this.cropChangeY+Math.abs(d+this.cropOldH)<=r-a?this.cropChangeY-Math.abs(d+this.cropOldH):a))),this.canChangeX&&this.fixed){var u=this.cropW/this.fixedNumber[0]*this.fixedNumber[1];u<l?(this.cropH=l,this.cropW=this.fixedNumber[0]*l/this.fixedNumber[1],this.changeCropTypeX===1&&(this.cropOffsertX=this.cropChangeX+(this.cropOldW-this.cropW))):u+this.cropOffsertY>r?(this.cropH=r-this.cropOffsertY,this.cropW=this.cropH/this.fixedNumber[1]*this.fixedNumber[0],this.changeCropTypeX===1&&(this.cropOffsertX=this.cropChangeX+(this.cropOldW-this.cropW))):this.cropH=u}if(this.canChangeY&&this.fixed){var p=this.cropH/this.fixedNumber[1]*this.fixedNumber[0];p<h?(this.cropW=h,this.cropH=this.fixedNumber[1]*h/this.fixedNumber[0],this.cropOffsertY=this.cropOldH+this.cropChangeY-this.cropH):p+this.cropOffsertX>o?(this.cropW=o-this.cropOffsertX,this.cropH=this.cropW/this.fixedNumber[0]*this.fixedNumber[1]):this.cropW=p}})},checkCropLimitSize(){let{cropW:e,cropH:t,limitMinSize:s}=this,o=new Array;return Array.isArray(s)?o=s:o=[s,s],e=parseFloat(o[0]),t=parseFloat(o[1]),[e,t]},changeCropEnd(e){window.removeEventListener("mousemove",this.changeCropNow),window.removeEventListener("mouseup",this.changeCropEnd),window.removeEventListener("touchmove",this.changeCropNow),window.removeEventListener("touchend",this.changeCropEnd)},calculateSize(e,t,s,o,r,i){const a=e/t;let h=r,l=i;return h<s&&(h=s,l=Math.ceil(h/a)),l<o&&(l=o,h=Math.ceil(l*a),h<s&&(h=s,l=Math.ceil(h/a))),h<r&&(h=r,l=Math.ceil(h/a)),l<i&&(l=i,h=Math.ceil(l*a)),{width:h,height:l}},endCrop(){this.cropW===0&&this.cropH===0&&(this.cropping=!1);let[e,t]=this.checkCropLimitSize();const{width:s,height:o}=this.fixed?this.calculateSize(this.fixedNumber[0],this.fixedNumber[1],e,t,this.cropW,this.cropH):{width:e,height:t};s>this.cropW&&(this.cropW=s,this.cropOffsertX+s>this.w&&(this.cropOffsertX=this.w-s)),o>this.cropH&&(this.cropH=o,this.cropOffsertY+o>this.h&&(this.cropOffsertY=this.h-o)),window.removeEventListener("mousemove",this.createCrop),window.removeEventListener("mouseup",this.endCrop),window.removeEventListener("touchmove",this.createCrop),window.removeEventListener("touchend",this.endCrop)},startCrop(){this.crop=!0},stopCrop(){this.crop=!1},clearCrop(){this.cropping=!1,this.cropW=0,this.cropH=0},cropMove(e){if(e.preventDefault(),!this.canMoveBox)return this.crop=!1,this.startMove(e),!1;if(e.touches&&e.touches.length===2)return this.crop=!1,this.startMove(e),this.leaveCrop(),!1;window.addEventListener("mousemove",this.moveCrop),window.addEventListener("mouseup",this.leaveCrop),window.addEventListener("touchmove",this.moveCrop),window.addEventListener("touchend",this.leaveCrop);let t="clientX"in e?e.clientX:e.touches[0].clientX,s="clientY"in e?e.clientY:e.touches[0].clientY,o,r;o=t-this.cropOffsertX,r=s-this.cropOffsertY,this.cropX=o,this.cropY=r,this.$emit("crop-moving",{moving:!0,axis:this.getCropAxis()})},moveCrop(e,t){let s=0,o=0;e&&(e.preventDefault(),s="clientX"in e?e.clientX:e.touches[0].clientX,o="clientY"in e?e.clientY:e.touches[0].clientY),this.$nextTick(()=>{let r,i,a=s-this.cropX,h=o-this.cropY;if(t&&(a=this.cropOffsertX,h=this.cropOffsertY),a<=0?r=0:a+this.cropW>this.w?r=this.w-this.cropW:r=a,h<=0?i=0:h+this.cropH>this.h?i=this.h-this.cropH:i=h,this.centerBox){let l=this.getImgAxis();r<=l.x1&&(r=l.x1),r+this.cropW>l.x2&&(r=l.x2-this.cropW),i<=l.y1&&(i=l.y1),i+this.cropH>l.y2&&(i=l.y2-this.cropH)}this.cropOffsertX=r,this.cropOffsertY=i,this.$emit("crop-moving",{moving:!0,axis:this.getCropAxis()})})},getImgAxis(e,t,s){e=e||this.x,t=t||this.y,s=s||this.scale;let o={x1:0,x2:0,y1:0,y2:0},r=this.trueWidth*s,i=this.trueHeight*s;switch(this.rotate){case 0:o.x1=e+this.trueWidth*(1-s)/2,o.x2=o.x1+this.trueWidth*s,o.y1=t+this.trueHeight*(1-s)/2,o.y2=o.y1+this.trueHeight*s;break;case 1:case-1:case 3:case-3:o.x1=e+this.trueWidth*(1-s)/2+(r-i)/2,o.x2=o.x1+this.trueHeight*s,o.y1=t+this.trueHeight*(1-s)/2+(i-r)/2,o.y2=o.y1+this.trueWidth*s;break;default:o.x1=e+this.trueWidth*(1-s)/2,o.x2=o.x1+this.trueWidth*s,o.y1=t+this.trueHeight*(1-s)/2,o.y2=o.y1+this.trueHeight*s;break}return o},getCropAxis(){let e={x1:0,x2:0,y1:0,y2:0};return e.x1=this.cropOffsertX,e.x2=e.x1+this.cropW,e.y1=this.cropOffsertY,e.y2=e.y1+this.cropH,e},leaveCrop(e){window.removeEventListener("mousemove",this.moveCrop),window.removeEventListener("mouseup",this.leaveCrop),window.removeEventListener("touchmove",this.moveCrop),window.removeEventListener("touchend",this.leaveCrop),this.$emit("crop-moving",{moving:!1,axis:this.getCropAxis()})},getCropChecked(e){let t=document.createElement("canvas"),s=new Image,o=this.rotate,r=this.trueWidth,i=this.trueHeight,a=this.cropOffsertX,h=this.cropOffsertY;s.onload=()=>{if(this.cropW!==0){let d=t.getContext("2d"),u=1;this.high&!this.full&&(u=window.devicePixelRatio),this.enlarge!==1&!this.full&&(u=Math.abs(Number(this.enlarge)));let p=this.cropW*u,y=this.cropH*u,f=r*this.scale*u,m=i*this.scale*u,x=(this.x-a+this.trueWidth*(1-this.scale)/2)*u,S=(this.y-h+this.trueHeight*(1-this.scale)/2)*u;switch(n(p,y),d.save(),this.fillColor&&(d.fillStyle=this.fillColor,d.fillRect(0,0,t.width,t.height)),o){case 0:this.full?(n(p/this.scale,y/this.scale),d.drawImage(s,x/this.scale,S/this.scale,f/this.scale,m/this.scale)):d.drawImage(s,x,S,f,m);break;case 1:case-3:this.full?(n(p/this.scale,y/this.scale),x=x/this.scale+(f/this.scale-m/this.scale)/2,S=S/this.scale+(m/this.scale-f/this.scale)/2,d.rotate(o*90*Math.PI/180),d.drawImage(s,S,-x-m/this.scale,f/this.scale,m/this.scale)):(x=x+(f-m)/2,S=S+(m-f)/2,d.rotate(o*90*Math.PI/180),d.drawImage(s,S,-x-m,f,m));break;case 2:case-2:this.full?(n(p/this.scale,y/this.scale),d.rotate(o*90*Math.PI/180),x=x/this.scale,S=S/this.scale,d.drawImage(s,-x-f/this.scale,-S-m/this.scale,f/this.scale,m/this.scale)):(d.rotate(o*90*Math.PI/180),d.drawImage(s,-x-f,-S-m,f,m));break;case 3:case-1:this.full?(n(p/this.scale,y/this.scale),x=x/this.scale+(f/this.scale-m/this.scale)/2,S=S/this.scale+(m/this.scale-f/this.scale)/2,d.rotate(o*90*Math.PI/180),d.drawImage(s,-S-f/this.scale,x,f/this.scale,m/this.scale)):(x=x+(f-m)/2,S=S+(m-f)/2,d.rotate(o*90*Math.PI/180),d.drawImage(s,-S-f,x,f,m));break;default:this.full?(n(p/this.scale,y/this.scale),d.drawImage(s,x/this.scale,S/this.scale,f/this.scale,m/this.scale)):d.drawImage(s,x,S,f,m)}d.restore()}else{let d=r*this.scale,u=i*this.scale,p=t.getContext("2d");switch(p.save(),this.fillColor&&(p.fillStyle=this.fillColor,p.fillRect(0,0,t.width,t.height)),o){case 0:n(d,u),p.drawImage(s,0,0,d,u);break;case 1:case-3:n(u,d),p.rotate(o*90*Math.PI/180),p.drawImage(s,0,-u,d,u);break;case 2:case-2:n(d,u),p.rotate(o*90*Math.PI/180),p.drawImage(s,-d,-u,d,u);break;case 3:case-1:n(u,d),p.rotate(o*90*Math.PI/180),p.drawImage(s,-d,0,d,u);break;default:n(d,u),p.drawImage(s,0,0,d,u)}p.restore()}e(t)};var l=this.img.substr(0,4);l!=="data"&&(s.crossOrigin="Anonymous"),s.src=this.imgs;function n(d,u){t.width=Math.round(d),t.height=Math.round(u)}},getCropData(e){this.getCropChecked(t=>{e(t.toDataURL("image/"+this.outputType,this.outputSize))})},getCropBlob(e){this.getCropChecked(t=>{t.toBlob(s=>e(s),"image/"+this.outputType,this.outputSize)})},showPreview(){if(this.isCanShow)this.isCanShow=!1,setTimeout(()=>{this.isCanShow=!0},16);else return!1;let e=this.cropW,t=this.cropH,s=this.scale;var o={};o.div={width:`${e}px`,height:`${t}px`};let r=(this.x-this.cropOffsertX)/s,i=(this.y-this.cropOffsertY)/s,a=0;o.w=e,o.h=t,o.url=this.imgs,o.img={width:`${this.trueWidth}px`,height:`${this.trueHeight}px`,transform:`scale(${s})translate3d(${r}px, ${i}px, ${a}px)rotateZ(${this.rotate*90}deg)`},o.html=`
      <div class="show-preview" style="width: ${o.w}px; height: ${o.h}px,; overflow: hidden">
        <div style="width: ${e}px; height: ${t}px">
          <img src=${o.url} style="width: ${this.trueWidth}px; height: ${this.trueHeight}px; transform:
          scale(${s})translate3d(${r}px, ${i}px, ${a}px)rotateZ(${this.rotate*90}deg)">
        </div>
      </div>`,this.$emit("real-time",o)},reload(){let e=new Image;e.onload=()=>{this.w=parseFloat(window.getComputedStyle(this.$refs.cropper).width),this.h=parseFloat(window.getComputedStyle(this.$refs.cropper).height),this.trueWidth=e.width,this.trueHeight=e.height,this.original?this.scale=1:this.scale=this.checkedMode(),this.$nextTick(()=>{this.x=-(this.trueWidth-this.trueWidth*this.scale)/2+(this.w-this.trueWidth*this.scale)/2,this.y=-(this.trueHeight-this.trueHeight*this.scale)/2+(this.h-this.trueHeight*this.scale)/2,this.loading=!1,this.autoCrop&&this.goAutoCrop(),this.$emit("img-load","success"),setTimeout(()=>{this.showPreview()},20)})},e.onerror=()=>{this.$emit("img-load","error")},e.src=this.imgs},checkedMode(){let e=1,t=this.trueWidth,s=this.trueHeight;const o=this.mode.split(" ");switch(o[0]){case"contain":this.trueWidth>this.w&&(e=this.w/this.trueWidth),this.trueHeight*e>this.h&&(e=this.h/this.trueHeight);break;case"cover":t=this.w,e=t/this.trueWidth,s=s*e,s<this.h&&(s=this.h,e=s/this.trueHeight);break;default:try{let r=o[0];if(r.search("px")!==-1){r=r.replace("px",""),t=parseFloat(r);const i=t/this.trueWidth;let a=1,h=o[1];h.search("px")!==-1&&(h=h.replace("px",""),s=parseFloat(h),a=s/this.trueHeight),e=Math.min(i,a)}if(r.search("%")!==-1&&(r=r.replace("%",""),t=parseFloat(r)/100*this.w,e=t/this.trueWidth),o.length===2&&r==="auto"){let i=o[1];i.search("px")!==-1&&(i=i.replace("px",""),s=parseFloat(i),e=s/this.trueHeight),i.search("%")!==-1&&(i=i.replace("%",""),s=parseFloat(i)/100*this.h,e=s/this.trueHeight)}}catch{e=1}}return e},goAutoCrop(e,t){if(this.imgs===""||this.imgs===null)return;this.clearCrop(),this.cropping=!0;let s=this.w,o=this.h;if(this.centerBox){const a=Math.abs(this.rotate)%2>0;let h=(a?this.trueHeight:this.trueWidth)*this.scale,l=(a?this.trueWidth:this.trueHeight)*this.scale;s=h<s?h:s,o=l<o?l:o}var r=e||parseFloat(this.autoCropWidth),i=t||parseFloat(this.autoCropHeight);(r===0||i===0)&&(r=s*.8,i=o*.8),r=r>s?s:r,i=i>o?o:i,this.fixed&&(i=r/this.fixedNumber[0]*this.fixedNumber[1]),i>this.h&&(i=this.h,r=i/this.fixedNumber[1]*this.fixedNumber[0]),this.changeCrop(r,i)},changeCrop(e,t){if(this.centerBox){let s=this.getImgAxis();e>s.x2-s.x1&&(e=s.x2-s.x1,t=e/this.fixedNumber[0]*this.fixedNumber[1]),t>s.y2-s.y1&&(t=s.y2-s.y1,e=t/this.fixedNumber[1]*this.fixedNumber[0])}this.cropW=e,this.cropH=t,this.checkCropLimitSize(),this.$nextTick(()=>{this.cropOffsertX=(this.w-this.cropW)/2,this.cropOffsertY=(this.h-this.cropH)/2,this.centerBox&&this.moveCrop(null,!0)})},refresh(){this.img,this.imgs="",this.scale=1,this.crop=!1,this.rotate=0,this.w=0,this.h=0,this.trueWidth=0,this.trueHeight=0,this.clearCrop(),this.$nextTick(()=>{this.checkedImg()})},rotateLeft(){this.rotate=this.rotate<=-3?0:this.rotate-1},rotateRight(){this.rotate=this.rotate>=3?0:this.rotate+1},rotateClear(){this.rotate=0},checkoutImgAxis(e,t,s){e=e||this.x,t=t||this.y,s=s||this.scale;let o=!0;if(this.centerBox){let r=this.getImgAxis(e,t,s),i=this.getCropAxis();r.x1>=i.x1&&(o=!1),r.x2<=i.x2&&(o=!1),r.y1>=i.y1&&(o=!1),r.y2<=i.y2&&(o=!1)}return o}},mounted(){this.support="onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll";let e=this;var t=navigator.userAgent;this.isIOS=!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(s,o,r){for(var i=atob(this.toDataURL(o,r).split(",")[1]),a=i.length,h=new Uint8Array(a),l=0;l<a;l++)h[l]=i.charCodeAt(l);s(new Blob([h],{type:e.type||"image/png"}))}}),this.showPreview(),this.checkedImg()},unmounted(){window.removeEventListener("mousemove",this.moveCrop),window.removeEventListener("mouseup",this.leaveCrop),window.removeEventListener("touchmove",this.moveCrop),window.removeEventListener("touchend",this.leaveCrop),this.cancelScale()}}),Go={key:0,class:"cropper-box"},Zo=["src"],Jo={class:"cropper-view-box"},Qo=["src"],es={key:1};function ts(e,t,s,o,r,i){return W(),I("div",{class:"vue-cropper",ref:"cropper",onMouseover:t[28]||(t[28]=(...a)=>e.scaleImg&&e.scaleImg(...a)),onMouseout:t[29]||(t[29]=(...a)=>e.cancelScale&&e.cancelScale(...a))},[e.imgs?(W(),I("div",Go,[ne(v("div",{class:"cropper-box-canvas",style:K({width:e.trueWidth+"px",height:e.trueHeight+"px",transform:"scale("+e.scale+","+e.scale+") translate3d("+e.x/e.scale+"px,"+e.y/e.scale+"px,0)rotateZ("+e.rotate*90+"deg)"})},[v("img",{src:e.imgs,alt:"cropper-img",ref:"cropperImg"},null,8,Zo)],4),[[pe,!e.loading]])])):ie("",!0),v("div",{class:$(["cropper-drag-box",{"cropper-move":e.move&&!e.crop,"cropper-crop":e.crop,"cropper-modal":e.cropping}]),onMousedown:t[0]||(t[0]=(...a)=>e.startMove&&e.startMove(...a)),onTouchstart:t[1]||(t[1]=(...a)=>e.startMove&&e.startMove(...a))},null,34),ne(v("div",{class:"cropper-crop-box",style:K({width:e.cropW+"px",height:e.cropH+"px",transform:"translate3d("+e.cropOffsertX+"px,"+e.cropOffsertY+"px,0)"})},[v("span",Jo,[v("img",{style:K({width:e.trueWidth+"px",height:e.trueHeight+"px",transform:"scale("+e.scale+","+e.scale+") translate3d("+(e.x-e.cropOffsertX)/e.scale+"px,"+(e.y-e.cropOffsertY)/e.scale+"px,0)rotateZ("+e.rotate*90+"deg)"}),src:e.imgs,alt:"cropper-img"},null,12,Qo)]),v("span",{class:"cropper-face cropper-move",onMousedown:t[2]||(t[2]=(...a)=>e.cropMove&&e.cropMove(...a)),onTouchstart:t[3]||(t[3]=(...a)=>e.cropMove&&e.cropMove(...a))},null,32),e.info?(W(),I("span",{key:0,class:"crop-info",style:K({top:e.cropInfo.top})},Se(e.cropInfo.width)+" × "+Se(e.cropInfo.height),5)):ie("",!0),e.fixedBox?ie("",!0):(W(),I("span",es,[v("span",{class:"crop-line line-w",onMousedown:t[4]||(t[4]=a=>e.changeCropSize(a,!1,!0,0,1)),onTouchstart:t[5]||(t[5]=a=>e.changeCropSize(a,!1,!0,0,1))},null,32),v("span",{class:"crop-line line-a",onMousedown:t[6]||(t[6]=a=>e.changeCropSize(a,!0,!1,1,0)),onTouchstart:t[7]||(t[7]=a=>e.changeCropSize(a,!0,!1,1,0))},null,32),v("span",{class:"crop-line line-s",onMousedown:t[8]||(t[8]=a=>e.changeCropSize(a,!1,!0,0,2)),onTouchstart:t[9]||(t[9]=a=>e.changeCropSize(a,!1,!0,0,2))},null,32),v("span",{class:"crop-line line-d",onMousedown:t[10]||(t[10]=a=>e.changeCropSize(a,!0,!1,2,0)),onTouchstart:t[11]||(t[11]=a=>e.changeCropSize(a,!0,!1,2,0))},null,32),v("span",{class:"crop-point point1",onMousedown:t[12]||(t[12]=a=>e.changeCropSize(a,!0,!0,1,1)),onTouchstart:t[13]||(t[13]=a=>e.changeCropSize(a,!0,!0,1,1))},null,32),v("span",{class:"crop-point point2",onMousedown:t[14]||(t[14]=a=>e.changeCropSize(a,!1,!0,0,1)),onTouchstart:t[15]||(t[15]=a=>e.changeCropSize(a,!1,!0,0,1))},null,32),v("span",{class:"crop-point point3",onMousedown:t[16]||(t[16]=a=>e.changeCropSize(a,!0,!0,2,1)),onTouchstart:t[17]||(t[17]=a=>e.changeCropSize(a,!0,!0,2,1))},null,32),v("span",{class:"crop-point point4",onMousedown:t[18]||(t[18]=a=>e.changeCropSize(a,!0,!1,1,0)),onTouchstart:t[19]||(t[19]=a=>e.changeCropSize(a,!0,!1,1,0))},null,32),v("span",{class:"crop-point point5",onMousedown:t[20]||(t[20]=a=>e.changeCropSize(a,!0,!1,2,0)),onTouchstart:t[21]||(t[21]=a=>e.changeCropSize(a,!0,!1,2,0))},null,32),v("span",{class:"crop-point point6",onMousedown:t[22]||(t[22]=a=>e.changeCropSize(a,!0,!0,1,2)),onTouchstart:t[23]||(t[23]=a=>e.changeCropSize(a,!0,!0,1,2))},null,32),v("span",{class:"crop-point point7",onMousedown:t[24]||(t[24]=a=>e.changeCropSize(a,!1,!0,0,2)),onTouchstart:t[25]||(t[25]=a=>e.changeCropSize(a,!1,!0,0,2))},null,32),v("span",{class:"crop-point point8",onMousedown:t[26]||(t[26]=a=>e.changeCropSize(a,!0,!0,2,2)),onTouchstart:t[27]||(t[27]=a=>e.changeCropSize(a,!0,!0,2,2))},null,32)]))],4),[[pe,e.cropping]])],544)}const os=qo(Do,[["render",ts],["__scopeId","data-v-69939069"]]);const ss=e=>(Ht("data-v-a4249b4e"),e=e(),Xt(),e),is={class:"conts","element-loading-background":"#fff","element-loading-text":"解析中",style:{height:"450px"}},rs={class:"look_img"},as=["src"],ns={class:"imgs_list_box"},ls={class:"imgs_list"},cs=["src"],hs={class:"slider-dfl"},us={"element-loading-background":"#fff","element-loading-text":"解析中",style:{height:"450px"}},ds={key:0,class:"conts_right"},ps={class:"l"},fs=["innerHTML"],ms={class:"r"},gs={class:"dialog-footer"},vs={class:"bottom_btn"},bs={class:"l"},ws=ss(()=>v("span",null,"选择本地封面",-1)),Cs={class:"r"},ys={__name:"videoCropper",props:{isShow:{type:Boolean,default:()=>!0},file:{type:Object,default:()=>({})}},emits:["closeDialog","confirmImg"],setup(e,{emit:t}){const s=t;let o=e;const r=Y(!1),i=Y("one"),a=Y(0),h=Y({}),l=ge({url:"",urlTwo:"",blob:{},img_list:[],videoTime:0,oldVideoFile:{}}),n=ge({img:"",outputSize:1,outputType:"jpeg",info:!0,canScale:!0,autoCrop:!0,autoCropWidth:192,autoCropHeight:108,fixedBox:!1,fixed:!1,fixedNumber:[16,9],canMove:!0,canMoveBox:!0,original:!0,centerBox:!1,infoTrue:!0,full:!1,enlarge:"10",mode:"contain"});J([()=>o.file,()=>o.isShow],(M,C)=>{o.isShow==!0&&o.file.type?o.file.type.includes("video")?M[0].name!=l.oldVideoFile.name&&M[0].size!=l.oldVideoFile.size&&(r.value=!0,w.loadings=!0,i.value="one",d()):(Je({message:"请选择视频格式的文件",grouping:!0,type:"error"}),s("closeDialog",!1)):o.isShow==!0&&(Je({message:"请选择视频格式的文件",grouping:!0,type:"error"}),s("closeDialog",!1))});const d=()=>{l.url="",l.blob={},l.img_list=[],l.videoTime=0,l.oldVideoFile=o.file;let M=new FileReader;M.onload=function(C){let _=document.createElement("video");_.src=C.target.result,_.addEventListener("loadedmetadata",async function(){const V=await x(o.file,Math.floor(_.duration));var b=document.createElement("img");b.setAttribute("src",V.url),b.onload=function(){var T=b.naturalWidth/b.naturalHeight;n.fixedNumber[0]=b.width/b.height;var F=90*T;let Q=Math.floor(960/F),Z=Math.floor(_.duration);l.videoTime=Z;for(var A=Math.floor(Z/(Q-1)),R=[],q=0;q<Q;q++)R.push(q*A);R[0]==0&&(R[0]=.1),R.forEach(async(j,U)=>{const G=await x(o.file,j);U==0&&(l.url=G.url,l.urlTwo=G.url,l.blob=G.blob),l.img_list.push(G.url)}),se(()=>{setTimeout(()=>{r.value=!1},2e3)})}})},M.readAsDataURL(o.file)},u=async M=>{const C=await x(o.file,M);l.url=C.url,l.urlTwo=C.url,l.blob=C.blob},p=M=>{var C=X(M);return C},y=async(M,C)=>{i.value=="two"&&(w.loadings=!0,se(()=>{setTimeout(()=>{w.loadings=!1},500)}))},f=()=>{s("closeDialog",!1)},m=()=>{s("closeDialog",!1),s("confirmImg",{url:l.url,blob:l.blob})},x=(M,C=0)=>new Promise(_=>{const V=document.createElement("video");V.currentTime=C,V.muted=!0,V.autoplay=!0,V.oncanplay=async()=>{const b=await S(V);_(b)},V.src=URL.createObjectURL(M)}),S=M=>new Promise(C=>{const _=document.createElement("canvas"),V=_.getContext("2d");_.width=M.videoWidth,_.height=M.videoHeight,V.drawImage(M,0,0,_.width,_.height),_.toBlob(b=>{C({blob:b,url:URL.createObjectURL(b)})})}),X=M=>{var C=Math.floor(M/3600),_=Math.floor(M%3600/60),V=Math.floor(M%60),b="";return C>0&&(b+=C+":"),b+=_+":"+V,b},w=ge({imgLookUrl:"",bgColor:"rgba(255,255,255,0)",loadings:!0}),P=M=>{w.imgLookUrl=M.html},L=M=>{let C=M.target.files[0];C&&(w.loadings=!0,l.urlTwo=URL.createObjectURL(C),se(()=>{setTimeout(()=>{w.loadings=!1},500)}))},E=()=>{h.value.getCropData(M=>{const C=new Image;C.src=M,C.onload=()=>{const _=document.createElement("canvas"),V=_.getContext("2d");_.width=C.width,_.height=C.height,V.drawImage(C,0,0,_.width,_.height),_.toBlob(b=>{s("closeDialog",!1),s("confirmImg",{url:URL.createObjectURL(b),blob:b})})}})};return(M,C)=>{const _=zo,V=wt,b=Ct,T=Ie,F=uo,Q=gt,Z=Vt;return W(),I("div",null,[z(Q,{"model-value":c(o).isShow,title:"","close-on-click-modal":!1,width:"1000px",class:"dialog-dfl","before-close":f},{footer:D(()=>[v("span",gs,[ne(z(T,{color:"#fe3355",onClick:m},{default:D(()=>[He(" 确认封面 ")]),_:1},512),[[pe,i.value=="one"]]),ne(v("div",vs,[v("div",bs,[z(T,{style:{"margin-right":"10px",position:"relative"}},{default:D(()=>[ws,v("input",{type:"file",id:"img-file",accept:"image/*",onChange:L},null,32)]),_:1}),z(F,{locale:"zhCn",modelValue:w.bgColor,"onUpdate:modelValue":C[2]||(C[2]=A=>w.bgColor=A),"show-alpha":""},null,8,["modelValue"])]),v("div",Cs,[z(T,{color:"#fe3355",onClick:E},{default:D(()=>[He(" 确认封面 ")]),_:1})])],512),[[pe,i.value=="two"]])])]),default:D(()=>[v("div",null,[z(b,{modelValue:i.value,"onUpdate:modelValue":C[1]||(C[1]=A=>i.value=A),class:"demo-tabs",onTabChange:y},{default:D(()=>[z(V,{label:"封面截取",name:"one"},{default:D(()=>[ne((W(),I("div",is,[ne(v("div",null,[v("div",rs,[v("img",{src:l.url,alt:""},null,8,as)]),v("div",ns,[v("div",ls,[(W(!0),I(me,null,xe(l.img_list,(A,R)=>(W(),I("div",{key:R,class:"imgs_item"},[v("img",{src:A,alt:""},null,8,cs)]))),128)),v("div",hs,[z(_,{modelValue:a.value,"onUpdate:modelValue":C[0]||(C[0]=A=>a.value=A),step:.1,min:0,max:l.videoTime,placement:"bottom","format-tooltip":p,onChange:u},null,8,["modelValue","max"])])])])],512),[[pe,!r.value]])])),[[Z,r.value]])]),_:1}),z(V,{label:"本地上传",name:"two"},{default:D(()=>[ne((W(),I("div",us,[w.loadings?ie("",!0):(W(),I("div",ds,[v("div",ps,[v("div",{innerHTML:w.imgLookUrl,style:K({backgroundColor:w.bgColor})},null,12,fs)]),v("div",ms,[z(c(os),{ref_key:"cropperRef",ref:h,img:l.urlTwo,outputSize:n.outputSize,outputType:n.outputType,info:n.info,canScale:n.canScale,autoCrop:n.autoCrop,autoCropWidth:n.autoCropWidth,autoCropHeight:n.autoCropHeight,fixedBox:n.fixedBox,fixed:n.fixed,fixedNumber:n.fixedNumber,canMove:n.canMove,canMoveBox:n.canMoveBox,original:n.original,centerBox:n.centerBox,infoTrue:n.infoTrue,full:n.full,enlarge:n.enlarge,mode:n.mode,fillColor:w.bgColor,onRealTime:P},null,8,["img","outputSize","outputType","info","canScale","autoCrop","autoCropWidth","autoCropHeight","fixedBox","fixed","fixedNumber","canMove","canMoveBox","original","centerBox","infoTrue","full","enlarge","mode","fillColor"])])]))])),[[Z,w.loadings]])]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["model-value"])])}}},qs=$t(ys,[["__scopeId","data-v-a4249b4e"]]);export{qs as default};
